<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>[Dacon] 여행상품 신청예측 - Just Do it</title>
<meta name="description" content="데이콘 Basic 여행상품 신청예측">


  <meta name="author" content="Tae Hyeon Kim">
  
  <meta property="article:author" content="Tae Hyeon Kim">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="Just Do it">
<meta property="og:title" content="[Dacon] 여행상품 신청예측">
<meta property="og:url" content="http://localhost:4000/dacon/prediction-of-trevel-product/">


  <meta property="og:description" content="데이콘 Basic 여행상품 신청예측">







  <meta property="article:published_time" content="2023-02-02T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/dacon/prediction-of-trevel-product/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Tae Hyeon Kim",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Just Do it Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="/assets/logo.ico/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/logo.ico/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/logo.ico/favicon-16x16.png">
<link rel="mask-icon" href="/assets/logo.ico/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Just Do it
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">Introduce</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Category</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Tae Hyeon Kim</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>I am an <strong>amazing</strong> person.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Somewhere</span>
        </li>
      

      
        
          
            <li><a href="mailto:ttth000221@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://github.com/Tae-Hyeon-Kim" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="[Dacon] 여행상품 신청예측">
    <meta itemprop="description" content="데이콘 Basic 여행상품 신청예측">
    <meta itemprop="datePublished" content="2023-02-02T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/dacon/prediction-of-trevel-product/" class="u-url" itemprop="url">[Dacon] 여행상품 신청예측
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-02-02T00:00:00+09:00">February 2, 2023</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          36 분 소요
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
              <ul class="toc__menu"><li><a href="#0준비">0.준비</a><ul><li><a href="#01데이터-전처리">0.1.데이터 전처리</a><ul><li><a href="#011결측치-처리">0.1.1.결측치 처리</a></li><li><a href="#012문자형-변수-전처리">0.1.2.문자형 변수 전처리</a></li><li><a href="#013추가-결측치-처리-모듈-생성">0.1.3.(추가) 결측치 처리 모듈 생성</a></li></ul></li></ul></li><li><a href="#1eda">1.EDA</a><ul><li><a href="#11target">1.1.target</a></li><li><a href="#12feature--target">1.2.feature &amp; target</a><ul><li><a href="#121feature-correlatoinfeature-importances">1.2.1.Feature correlatoin(feature importances)</a></li><li><a href="#122citytier--target">1.2.2.CityTier ~ target</a></li><li><a href="#123passport--target">1.2.3.Passport ~ target</a></li><li><a href="#124-productpitched--target">1.2.4. ProductPitched ~ target</a></li><li><a href="#125maritalstatus--target">1.2.5.MaritalStatus ~ target</a></li><li><a href="#126citytier--monthlyincome">1.2.6.CityTier ~ MonthlyIncome</a></li><li><a href="#127designation--monthlyincome">1.2.7.Designation ~ MonthlyIncome</a></li><li><a href="#128numberoftrips--monthlyincome">1.2.8.NumberOfTrips ~ MonthlyIncome</a></li><li><a href="#129durationofpitch--pitchsatisfactionscore">1.2.9.DurationOfPitch ~ PitchSatisfactionScore</a></li><li><a href="#1210heatmap">1.2.10.heatmap</a></li></ul></li><li><a href="#13heatmap-정보를-기반으로-eda">1.3.heatmap 정보를 기반으로 EDA</a><ul><li><a href="#131-monthlyincome--age">1.3.1. MonthlyIncome ~ Age</a><ul><li><a href="#1311age가-0인-데이터-age-예측">1.3.1.1.Age가 0인 데이터 age 예측</a></li></ul></li><li><a href="#132monthlyincome--numberofpersonvisiting">1.3.2.MonthlyIncome ~ NumberOfPersonVisiting</a></li><li><a href="#133monthlyincome--durationofpitch">1.3.3.MonthlyIncome ~ DurationOfPitch</a></li></ul></li></ul></li><li><a href="#2feature-engineering">2.Feature engineering</a><ul><li><a href="#21drop">2.1.drop</a></li><li><a href="#22scaling">2.2.scaling</a></li></ul></li><li><a href="#3모델링을-위한-데이터-전처리">3.모델링을 위한 데이터 전처리</a><ul><li><a href="#013추가-결측치-처리-모듈-생성-1">0.1.3.(추가) 결측치 처리 모듈 생성</a></li><li><a href="#31결측치-처리">3.1.결측치 처리</a></li></ul></li><li><a href="#32문자형-변수-전처리">3.2.문자형 변수 전처리</a></li><li><a href="#33결측치-처리-모듈-적용">3.3.결측치 처리 모듈 적용</a></li><li><a href="#33모듈대체-age가-0인-데이터-age-예측">3.3.(모듈대체) Age가 0인 데이터 age 예측</a></li><li><a href="#34모듈대체-monthly-income-결측치-예측">3.4.(모듈대체) Monthly Income 결측치 예측</a></li><li><a href="#34scaling">3.4.scaling</a></li></ul></li><li><a href="#4모델링">4.모델링</a><ul><li><a href="#41randomforestclassifier">4.1.RandomForestClassifier</a></li><li><a href="#42xgboost">4.2.Xgboost</a></li><li><a href="#43catboost">4.3.catboost</a></li><li><a href="#44lightgbm">4.4.LightGBM</a></li><li><a href="#45extratrees">4.5.ExtraTrees</a></li></ul></li><li><a href="#5모델-앙상블">5.모델 앙상블</a></li></ul>

            </nav>
          </aside>
        
        <p>데이콘 Basic 여행상품 신청예측</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="p">.</span><span class="nf">mount</span><span class="p">(</span><span class="s">'/content/drive'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mounted at /content/drive
</code></pre></div></div>

<h1 id="0준비">0.준비</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">'/content/drive/MyDrive/data/여행상품신청/train.csv'</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">'/content/drive/MyDrive/data/여행상품신청/test.csv'</span><span class="p">)</span>
<span class="n">sample_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">'/content/drive/MyDrive/data/여행상품신청/sample_submission.csv'</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>id : 샘플 아이디</li>
  <li>Age : 나이</li>
  <li>TypeofContact : 고객의 제품 인지 방법 (회사의 홍보 or 스스로 검색)</li>
  <li>CityTier : 주거 중인 도시의 등급. (인구, 시설, 생활 수준 기준) (1등급 &gt; 2등급 &gt; 3등급)</li>
  <li>DurationOfPitch : 영업 사원이 고객에게 제공하는 프레젠테이션 기간</li>
  <li>Occupation : 직업</li>
  <li>Gender : 성별</li>
  <li>NumberOfPersonVisiting : 고객과 함께 여행을 계획 중인 총 인원</li>
  <li>NumberOfFollowups : 영업 사원의 프레젠테이션 후 이루어진 후속 조치 수</li>
  <li>ProductPitched : 영업 사원이 제시한 상품</li>
  <li>PreferredPropertyStar : 선호 호텔 숙박업소 등급</li>
  <li>MaritalStatus : 결혼여부</li>
  <li>NumberOfTrips : 평균 연간 여행 횟수</li>
  <li>Passport : 여권 보유 여부 (0: 없음, 1: 있음)</li>
  <li>PitchSatisfactionScore : 영업 사원의 프레젠테이션 만족도</li>
  <li>OwnCar : 자동차 보유 여부 (0: 없음, 1: 있음)</li>
  <li>NumberOfChildrenVisiting : 함께 여행을 계획 중인 5세 미만의 어린이 수</li>
  <li>Designation : (직업의) 직급</li>
  <li>MonthlyIncome : 월 급여</li>
  <li>ProdTaken : 여행 패키지 신청 여부 (0: 신청 안 함, 1: 신청함)</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span>
</code></pre></div></div>

<div id="df-8b5e1c8d-1549-4eb7-ad44-aeff9f978c8f">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
      <th>ProdTaken</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>28.0</td>
      <td>Company Invited</td>
      <td>1</td>
      <td>10.0</td>
      <td>Small Business</td>
      <td>Male</td>
      <td>3</td>
      <td>4.0</td>
      <td>Basic</td>
      <td>3.0</td>
      <td>Married</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>Executive</td>
      <td>20384.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>34.0</td>
      <td>Self Enquiry</td>
      <td>3</td>
      <td>NaN</td>
      <td>Small Business</td>
      <td>Female</td>
      <td>2</td>
      <td>4.0</td>
      <td>Deluxe</td>
      <td>4.0</td>
      <td>Single</td>
      <td>1.0</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>0.0</td>
      <td>Manager</td>
      <td>19599.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>45.0</td>
      <td>Company Invited</td>
      <td>1</td>
      <td>NaN</td>
      <td>Salaried</td>
      <td>Male</td>
      <td>2</td>
      <td>3.0</td>
      <td>Deluxe</td>
      <td>4.0</td>
      <td>Married</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0.0</td>
      <td>Manager</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>29.0</td>
      <td>Company Invited</td>
      <td>1</td>
      <td>7.0</td>
      <td>Small Business</td>
      <td>Male</td>
      <td>3</td>
      <td>5.0</td>
      <td>Basic</td>
      <td>4.0</td>
      <td>Married</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1.0</td>
      <td>Executive</td>
      <td>21274.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>42.0</td>
      <td>Self Enquiry</td>
      <td>3</td>
      <td>6.0</td>
      <td>Salaried</td>
      <td>Male</td>
      <td>2</td>
      <td>3.0</td>
      <td>Deluxe</td>
      <td>3.0</td>
      <td>Divorced</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.0</td>
      <td>Manager</td>
      <td>19907.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>1951</td>
      <td>28.0</td>
      <td>Self Enquiry</td>
      <td>1</td>
      <td>10.0</td>
      <td>Small Business</td>
      <td>Male</td>
      <td>3</td>
      <td>5.0</td>
      <td>Basic</td>
      <td>3.0</td>
      <td>Single</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>Executive</td>
      <td>20723.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>1952</td>
      <td>41.0</td>
      <td>Self Enquiry</td>
      <td>3</td>
      <td>8.0</td>
      <td>Salaried</td>
      <td>Female</td>
      <td>3</td>
      <td>3.0</td>
      <td>Super Deluxe</td>
      <td>5.0</td>
      <td>Divorced</td>
      <td>1.0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>1.0</td>
      <td>AVP</td>
      <td>31595.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>1953</td>
      <td>38.0</td>
      <td>Company Invited</td>
      <td>3</td>
      <td>28.0</td>
      <td>Small Business</td>
      <td>Female</td>
      <td>3</td>
      <td>4.0</td>
      <td>Basic</td>
      <td>3.0</td>
      <td>Divorced</td>
      <td>7.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>2.0</td>
      <td>Executive</td>
      <td>21651.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>1954</td>
      <td>28.0</td>
      <td>Self Enquiry</td>
      <td>3</td>
      <td>30.0</td>
      <td>Small Business</td>
      <td>Female</td>
      <td>3</td>
      <td>5.0</td>
      <td>Deluxe</td>
      <td>3.0</td>
      <td>Married</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>Manager</td>
      <td>22218.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>1955</td>
      <td>22.0</td>
      <td>Company Invited</td>
      <td>1</td>
      <td>9.0</td>
      <td>Salaried</td>
      <td>Male</td>
      <td>2</td>
      <td>4.0</td>
      <td>Basic</td>
      <td>3.0</td>
      <td>Divorced</td>
      <td>1.0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
      <td>Executive</td>
      <td>17853.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1955 rows × 20 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8b5e1c8d-1549-4eb7-ad44-aeff9f978c8f')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-8b5e1c8d-1549-4eb7-ad44-aeff9f978c8f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-8b5e1c8d-1549-4eb7-ad44-aeff9f978c8f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<h2 id="01데이터-전처리">0.1.데이터 전처리</h2>

<h3 id="011결측치-처리">0.1.1.결측치 처리</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="nf">isna</span><span class="p">().</span><span class="nf">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>id                            0
Age                          94
TypeofContact                10
CityTier                      0
DurationOfPitch             102
Occupation                    0
Gender                        0
NumberOfPersonVisiting        0
NumberOfFollowups            13
ProductPitched                0
PreferredPropertyStar        10
MaritalStatus                 0
NumberOfTrips                57
Passport                      0
PitchSatisfactionScore        0
OwnCar                        0
NumberOfChildrenVisiting     27
Designation                   0
MonthlyIncome               100
ProdTaken                     0
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="nf">isna</span><span class="p">().</span><span class="nf">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>id                            0
Age                         132
TypeofContact                15
CityTier                      0
DurationOfPitch             149
Occupation                    0
Gender                        0
NumberOfPersonVisiting        0
NumberOfFollowups            32
ProductPitched                0
PreferredPropertyStar        16
MaritalStatus                 0
NumberOfTrips                83
Passport                      0
PitchSatisfactionScore        0
OwnCar                        0
NumberOfChildrenVisiting     39
Designation                   0
MonthlyIncome               133
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">handle_na</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">.</span><span class="n">dtypes</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s">'object'</span><span class="p">:</span>
            <span class="c1"># 문자형 칼럼의 경우 'Unknown'을 채워줍니다.
</span>            <span class="n">value</span> <span class="o">=</span> <span class="s">'Unknown'</span>
        <span class="k">elif</span> <span class="n">dtype</span> <span class="o">==</span> <span class="nb">int</span> <span class="ow">or</span> <span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
            <span class="c1"># 수치형 칼럼의 경우 0을 채워줍니다.
</span>            <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">temp</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nf">fillna</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">temp</span>

<span class="n">train_nona</span> <span class="o">=</span> <span class="nf">handle_na</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>

<span class="c1"># 결측치 처리가 잘 되었는지 확인해 줍니다.
</span><span class="n">train_nona</span><span class="p">.</span><span class="nf">isna</span><span class="p">().</span><span class="nf">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>id                          0
Age                         0
TypeofContact               0
CityTier                    0
DurationOfPitch             0
Occupation                  0
Gender                      0
NumberOfPersonVisiting      0
NumberOfFollowups           0
ProductPitched              0
PreferredPropertyStar       0
MaritalStatus               0
NumberOfTrips               0
Passport                    0
PitchSatisfactionScore      0
OwnCar                      0
NumberOfChildrenVisiting    0
Designation                 0
MonthlyIncome               0
ProdTaken                   0
dtype: int64
</code></pre></div></div>

<h3 id="012문자형-변수-전처리">0.1.2.문자형 변수 전처리</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">object_columns</span> <span class="o">=</span> <span class="n">train_nona</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="n">train_nona</span><span class="p">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s">'object'</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="s">'object 칼럼은 다음과 같습니다 : '</span><span class="p">,</span> <span class="nf">list</span><span class="p">(</span><span class="n">object_columns</span><span class="p">))</span>

<span class="c1"># 해당 칼럼만 보아서 봅시다
</span><span class="n">train_nona</span><span class="p">[</span><span class="n">object_columns</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>object 칼럼은 다음과 같습니다 :  ['TypeofContact', 'Occupation', 'Gender', 'ProductPitched', 'MaritalStatus', 'Designation']
</code></pre></div></div>

<div id="df-997d698d-5365-4ab9-856a-0c0fac20d880">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TypeofContact</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>ProductPitched</th>
      <th>MaritalStatus</th>
      <th>Designation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Company Invited</td>
      <td>Small Business</td>
      <td>Male</td>
      <td>Basic</td>
      <td>Married</td>
      <td>Executive</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Self Enquiry</td>
      <td>Small Business</td>
      <td>Female</td>
      <td>Deluxe</td>
      <td>Single</td>
      <td>Manager</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Company Invited</td>
      <td>Salaried</td>
      <td>Male</td>
      <td>Deluxe</td>
      <td>Married</td>
      <td>Manager</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Company Invited</td>
      <td>Small Business</td>
      <td>Male</td>
      <td>Basic</td>
      <td>Married</td>
      <td>Executive</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Self Enquiry</td>
      <td>Salaried</td>
      <td>Male</td>
      <td>Deluxe</td>
      <td>Divorced</td>
      <td>Manager</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>Self Enquiry</td>
      <td>Small Business</td>
      <td>Male</td>
      <td>Basic</td>
      <td>Single</td>
      <td>Executive</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>Self Enquiry</td>
      <td>Salaried</td>
      <td>Female</td>
      <td>Super Deluxe</td>
      <td>Divorced</td>
      <td>AVP</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>Company Invited</td>
      <td>Small Business</td>
      <td>Female</td>
      <td>Basic</td>
      <td>Divorced</td>
      <td>Executive</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>Self Enquiry</td>
      <td>Small Business</td>
      <td>Female</td>
      <td>Deluxe</td>
      <td>Married</td>
      <td>Manager</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>Company Invited</td>
      <td>Salaried</td>
      <td>Male</td>
      <td>Basic</td>
      <td>Divorced</td>
      <td>Executive</td>
    </tr>
  </tbody>
</table>
<p>1955 rows × 6 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-997d698d-5365-4ab9-856a-0c0fac20d880')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-997d698d-5365-4ab9-856a-0c0fac20d880 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-997d698d-5365-4ab9-856a-0c0fac20d880');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_nona</span><span class="p">[</span><span class="s">'Gender'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Male       1207
Female      692
Fe Male      56
Name: Gender, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_nona</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_nona</span><span class="p">[</span><span class="s">'Gender'</span><span class="p">]</span><span class="o">==</span><span class="s">'Fe Male'</span><span class="p">,</span><span class="s">'Gender'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Female'</span>
<span class="n">test</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="s">'Gender'</span><span class="p">]</span><span class="o">==</span><span class="s">'Fe Male'</span><span class="p">,</span><span class="s">'Gender'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Female'</span>
<span class="n">train_nona</span><span class="p">[</span><span class="s">'Gender'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Male      1207
Female     748
Name: Gender, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># LabelEncoder를 준비해줍니다.
</span><span class="kn">from</span> <span class="n">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="nc">LabelEncoder</span><span class="p">()</span>

<span class="c1"># LabelEcoder는 학습하는 과정을 필요로 합니다.
</span><span class="n">encoder</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">train_nona</span><span class="p">[</span><span class="s">'TypeofContact'</span><span class="p">])</span>

<span class="c1">#학습된 encoder를 사용하여 문자형 변수를 숫자로 변환해줍니다.
</span><span class="n">encoder</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">train_nona</span><span class="p">[</span><span class="s">'TypeofContact'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([0, 1, 0, ..., 0, 1, 0])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span> <span class="o">=</span> <span class="n">train_nona</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>

<span class="c1"># 모든 문자형 변수에 대해 encoder를 적용합니다.
</span><span class="k">for</span> <span class="n">o_col</span> <span class="ow">in</span> <span class="n">object_columns</span><span class="p">:</span>
    <span class="n">encoder</span> <span class="o">=</span> <span class="nc">LabelEncoder</span><span class="p">()</span>
    <span class="n">encoder</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[</span><span class="n">o_col</span><span class="p">])</span>
    <span class="n">train_enc</span><span class="p">[</span><span class="n">o_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[</span><span class="n">o_col</span><span class="p">])</span>

<span class="c1"># 결과를 확인합니다.
</span><span class="n">train_enc</span>
</code></pre></div></div>

<div id="df-3e59f428-b306-41d5-85bd-2686f5982d9d">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
      <th>ProdTaken</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>28.0</td>
      <td>0</td>
      <td>1</td>
      <td>10.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>20384.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>34.0</td>
      <td>1</td>
      <td>3</td>
      <td>0.0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>4.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>19599.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>45.0</td>
      <td>0</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>29.0</td>
      <td>0</td>
      <td>1</td>
      <td>7.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>21274.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>42.0</td>
      <td>1</td>
      <td>3</td>
      <td>6.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>19907.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>1951</td>
      <td>28.0</td>
      <td>1</td>
      <td>1</td>
      <td>10.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>2</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>20723.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>1952</td>
      <td>41.0</td>
      <td>1</td>
      <td>3</td>
      <td>8.0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>3.0</td>
      <td>4</td>
      <td>5.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>31595.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>1953</td>
      <td>38.0</td>
      <td>0</td>
      <td>3</td>
      <td>28.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>7.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>21651.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>1954</td>
      <td>28.0</td>
      <td>1</td>
      <td>3</td>
      <td>30.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>5.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>2</td>
      <td>22218.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>1955</td>
      <td>22.0</td>
      <td>0</td>
      <td>1</td>
      <td>9.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>17853.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1955 rows × 20 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3e59f428-b306-41d5-85bd-2686f5982d9d')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-3e59f428-b306-41d5-85bd-2686f5982d9d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-3e59f428-b306-41d5-85bd-2686f5982d9d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 결측치 처리
</span><span class="n">test</span> <span class="o">=</span> <span class="nf">handle_na</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="c1"># 문자형 변수 전처리
</span><span class="k">for</span> <span class="n">o_col</span> <span class="ow">in</span> <span class="n">object_columns</span><span class="p">:</span>
    <span class="n">encoder</span> <span class="o">=</span> <span class="nc">LabelEncoder</span><span class="p">()</span>
    
    <span class="c1"># test 데이터를 이용해 encoder를 학습하는 것은 Data Leakage 입니다! 조심!
</span>    <span class="n">encoder</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">train_nona</span><span class="p">[</span><span class="n">o_col</span><span class="p">])</span>
    
    <span class="c1"># test 데이터는 오로지 transform 에서만 사용되어야 합니다.
</span>    <span class="n">test</span><span class="p">[</span><span class="n">o_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">o_col</span><span class="p">])</span>

<span class="c1"># 결과를 확인합니다.
</span><span class="n">test</span>
</code></pre></div></div>

<div id="df-32387cc9-c583-4576-8e0c-f342b95f16ea">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.524590</td>
      <td>0</td>
      <td>3</td>
      <td>0.000000</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>5.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>-0.363121</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.754098</td>
      <td>1</td>
      <td>2</td>
      <td>0.305556</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>-0.316471</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.606557</td>
      <td>1</td>
      <td>3</td>
      <td>0.611111</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>5.0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>-0.142953</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.704918</td>
      <td>1</td>
      <td>1</td>
      <td>1.000000</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>6.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>3</td>
      <td>6.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>2.0</td>
      <td>2</td>
      <td>0.070608</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.409836</td>
      <td>1</td>
      <td>3</td>
      <td>0.194444</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>-0.070797</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2928</th>
      <td>2929</td>
      <td>0.885246</td>
      <td>1</td>
      <td>1</td>
      <td>0.166667</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>3.0</td>
      <td>4</td>
      <td>3.0</td>
      <td>2</td>
      <td>7.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>1.309948</td>
    </tr>
    <tr>
      <th>2929</th>
      <td>2930</td>
      <td>0.540984</td>
      <td>1</td>
      <td>1</td>
      <td>0.250000</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>2.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>0.174085</td>
    </tr>
    <tr>
      <th>2930</th>
      <td>2931</td>
      <td>0.540984</td>
      <td>0</td>
      <td>1</td>
      <td>0.861111</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>0.207652</td>
    </tr>
    <tr>
      <th>2931</th>
      <td>2932</td>
      <td>0.426230</td>
      <td>1</td>
      <td>1</td>
      <td>0.250000</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>2.0</td>
      <td>0</td>
      <td>5.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>-0.041459</td>
    </tr>
    <tr>
      <th>2932</th>
      <td>2933</td>
      <td>0.508197</td>
      <td>1</td>
      <td>1</td>
      <td>0.250000</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>5.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>0.054749</td>
    </tr>
  </tbody>
</table>
<p>2933 rows × 19 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-32387cc9-c583-4576-8e0c-f342b95f16ea')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-32387cc9-c583-4576-8e0c-f342b95f16ea button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-32387cc9-c583-4576-8e0c-f342b95f16ea');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<h3 id="013추가-결측치-처리-모듈-생성">0.1.3.(추가) 결측치 처리 모듈 생성</h3>
<ul>
  <li>0으로 채운 수치형 컬럼의 결측치를 회귀예측 모델로 예측하여 채워넣는 모듈 생성</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesRegressor</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">prod_val</span><span class="p">(</span><span class="n">feature</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
  <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="k">return</span> <span class="s">'already processed'</span>
  <span class="n">train_temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>

  <span class="n">features</span> <span class="o">=</span> <span class="n">train_temp</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">drop</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
  <span class="n">target</span> <span class="o">=</span> <span class="n">feature</span>

  <span class="n">X</span> <span class="o">=</span> <span class="n">train_temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">train_temp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>

  <span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">train_size</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
  <span class="n">model_rf</span> <span class="o">=</span> <span class="nc">ExtraTreesRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

  <span class="n">model_rf</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

  <span class="n">train_predict</span> <span class="o">=</span> <span class="n">model_rf</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

  <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s"> MAE: </span><span class="si">{</span><span class="nf">mean_absolute_error</span><span class="p">(</span><span class="n">train_predict</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

  <span class="n">X</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="n">features</span><span class="p">]</span>

  <span class="n">train_enc</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_rf</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

  <span class="n">test_temp</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>

  <span class="n">X</span> <span class="o">=</span> <span class="n">test_temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>

  <span class="n">test</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_rf</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

  <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="se">\n</span><span class="s">train set: </span><span class="se">\n</span><span class="si">{</span><span class="n">train_enc</span><span class="p">[</span><span class="n">feature</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">().</span><span class="nf">sort_index</span><span class="p">().</span><span class="nf">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
  <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="se">\n</span><span class="s">test set: </span><span class="se">\n</span><span class="si">{</span><span class="n">test</span><span class="p">[</span><span class="n">feature</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">().</span><span class="nf">sort_index</span><span class="p">().</span><span class="nf">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="1eda">1.EDA</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
</code></pre></div></div>

<h2 id="11target">1.1.target</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">train_enc</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">().</span><span class="nf">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">'target distribution'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'not application'</span><span class="p">,</span><span class="s">'application'</span><span class="p">],</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536439-b3115f47-6f39-41ae-8b41-92615b7aa62f.png" alt="" /></p>

<h2 id="12feature--target">1.2.feature &amp; target</h2>

<h3 id="121feature-correlatoinfeature-importances">1.2.1.Feature correlatoin(feature importances)</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">train_enc</span><span class="p">.</span><span class="nf">corr</span><span class="p">()[</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="n">values</span><span class="p">))</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">.</span><span class="nf">corr</span><span class="p">()[</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="n">index</span>

<span class="n">values</span> <span class="o">=</span> <span class="nf">abs</span><span class="p">(</span><span class="n">train_enc</span><span class="p">.</span><span class="nf">corr</span><span class="p">()[</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="n">values</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">'Feature correlation with target'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">barh</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">yticks</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536446-b7da79aa-62c2-452c-90ce-1665a84f77b8.png" alt="" /></p>

<ul>
  <li>여권의 유무가 target과 가장 상관관계가 높은 것을 알 수 있다.</li>
</ul>

<h3 id="122citytier--target">1.2.2.CityTier ~ target</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="s">'CityTier'</span><span class="p">,</span><span class="s">'ProdTaken'</span><span class="p">])[</span><span class="s">'id'</span><span class="p">].</span><span class="nf">count</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CityTier  ProdTaken
1         0            1065
          1             218
2         0              66
          1              24
3         0             441
          1             141
Name: id, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="s">'CityTier'</span><span class="p">,</span><span class="s">'ProdTaken'</span><span class="p">])[</span><span class="s">'id'</span><span class="p">].</span><span class="nf">count</span><span class="p">().</span><span class="n">values</span>
<span class="n">temp</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([1065,  218,   66,   24,  441,  141])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">no_application</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">no_application</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([1065,   66,  441])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">no_application</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'b'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">application</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">no_application</span><span class="p">)</span> <span class="c1"># stacked bar chart
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">'Target distribution according to CityTier'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'CityTier'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">'ProdTaken'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">((</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="s">'no application'</span><span class="p">,</span><span class="s">'application'</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536451-114b4b36-6642-4986-8b5f-a29da89d6950.png" alt="" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ratio</span>  <span class="o">=</span> <span class="n">application</span> <span class="o">/</span> <span class="n">no_application</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ratio</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'CityTier'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">'application ratio'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536454-b0a4423b-1ac2-4e63-8d2c-f67f380bd03a.png" alt="" /></p>

<ul>
  <li>그래프를 통해 2등급 도시에는 주거 중인 시민이 별로 없다는 것을 알 수 있다.</li>
  <li>또한 신청자 수는 1등급 도시에서 가장 많았지만 각 도시별 신청자 수 비율을 보면 2등급 도시가 가장 높은 것을 알 수 있다.</li>
</ul>

<h3 id="123passport--target">1.2.3.Passport ~ target</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="s">'Passport'</span><span class="p">,</span><span class="s">'ProdTaken'</span><span class="p">])[</span><span class="s">'id'</span><span class="p">].</span><span class="nf">count</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Passport  ProdTaken
0         0            1218
          1             168
1         0             354
          1             215
Name: id, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="s">'Passport'</span><span class="p">,</span><span class="s">'ProdTaken'</span><span class="p">])[</span><span class="s">'id'</span><span class="p">].</span><span class="nf">count</span><span class="p">().</span><span class="n">values</span>
<span class="n">temp</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([1218,  168,  354,  215])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">no_application</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">no_application</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([1218,  354])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">no_application</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'b'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">application</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">no_application</span><span class="p">)</span> <span class="c1"># stacked bar chart
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">'Target distribution according to Passport'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'Passport'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">'ProdTaken'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">'no passport'</span><span class="p">,</span><span class="s">'passport'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">((</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="s">'no application'</span><span class="p">,</span><span class="s">'application'</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536459-16c6dd37-a684-4379-b3b3-4222b914db6a.png" alt="" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">).</span><span class="nf">flatten</span><span class="p">()</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'Passport'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">].</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">plot</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">ax1</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'no passport'</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">'no application'</span><span class="p">,</span><span class="s">'application'</span><span class="p">])</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'Passport'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">].</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">plot</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">ax2</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'have passport'</span><span class="p">)</span>


<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536463-36ea8ad1-2047-40e7-8f69-c07fecae3e28.png" alt="" /></p>

<ul>
  <li>그래프를 통해 여권을 가지고 있는 사람은 가지고 있지 않는 사람보다 더 높은 비율로 신청을 하는 것으로 보인다. (어찌보면 당연한 결과이다.)</li>
</ul>

<h3 id="124-productpitched--target">1.2.4. ProductPitched ~ target</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_nona</span><span class="p">[</span><span class="s">'ProductPitched'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array(['Basic', 'Deluxe', 'King', 'Standard', 'Super Deluxe'],
      dtype=object)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_nona</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="s">'ProductPitched'</span><span class="p">,</span><span class="s">'ProdTaken'</span><span class="p">])[</span><span class="s">'id'</span><span class="p">].</span><span class="nf">count</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ProductPitched  ProdTaken
Basic           0            522
                1            223
Deluxe          0            599
                1             90
King            0             80
                1              9
Standard        0            251
                1             51
Super Deluxe    0            120
                1             10
Name: id, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">train_nona</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="s">'ProductPitched'</span><span class="p">,</span><span class="s">'ProdTaken'</span><span class="p">])[</span><span class="s">'id'</span><span class="p">].</span><span class="nf">count</span><span class="p">().</span><span class="n">values</span>
<span class="n">temp</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([522, 223, 599,  90,  80,   9, 251,  51, 120,  10])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ind</span> <span class="o">=</span> <span class="n">train_nona</span><span class="p">[</span><span class="s">'ProductPitched'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>
<span class="n">ind</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array(['Basic', 'Deluxe', 'King', 'Standard', 'Super Deluxe'],
      dtype=object)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">no_application</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">]]</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">]]</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">no_application</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([522, 599,  80, 251, 120])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">no_application</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'b'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">application</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">no_application</span><span class="p">)</span> <span class="c1"># stacked bar chart
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">'Target distribution according to ProductPitched'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'ProductPitched'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">'ProdTaken'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">((</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),(</span><span class="s">'no application'</span><span class="p">,</span><span class="s">'application'</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536467-9fcfc7df-d667-4486-834c-c5541a45296d.png" alt="" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ratio</span>  <span class="o">=</span> <span class="n">application</span> <span class="o">/</span> <span class="n">no_application</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">ratio</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'ProductPitched'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">'application ratio'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536472-17165ac7-a4ab-4706-b21f-b5181e3c6505.png" alt="" /></p>

<ul>
  <li>그래프를 통해 영업사원이 Basic 상품을 추천했을때 가장 신청률이 높은 것을 알 수 있다.</li>
</ul>

<h3 id="125maritalstatus--target">1.2.5.MaritalStatus ~ target</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_nona</span><span class="p">[</span><span class="s">'MaritalStatus'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Married      949
Divorced     375
Single       349
Unmarried    282
Name: MaritalStatus, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="s">'MaritalStatus'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1    949
0    375
2    349
3    282
Name: MaritalStatus, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span><span class="n">ax3</span><span class="p">,</span><span class="n">ax4</span><span class="p">)</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">).</span><span class="nf">flatten</span><span class="p">()</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'MaritalStatus'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">].</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">plot</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">ax1</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'Divorced'</span><span class="p">)</span>


<span class="n">temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'MaritalStatus'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">].</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">plot</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">ax2</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'Married'</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'MaritalStatus'</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">].</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">plot</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">ax3</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'Single'</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'MaritalStatus'</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">].</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">plot</span><span class="p">.</span><span class="nf">pie</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span><span class="n">ax4</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'Unmarried'</span><span class="p">)</span>
<span class="n">ax4</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">'no application'</span><span class="p">,</span><span class="s">'application'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span> 
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536475-6d178b59-73f2-4739-b2a3-99d55fbdbc50.png" alt="" /></p>

<ul>
  <li>Divorced 는 이혼한 사람을 뜻하는데 이혼한 사람과 결혼한 사람이 비슷한 신청률을 보였고, 미혼인 사람과 싱글인 사람이 25퍼센트가 넘는 신청률을 보였다.</li>
</ul>

<h3 id="126citytier--monthlyincome">1.2.6.CityTier ~ MonthlyIncome</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'font.size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">.</span><span class="nf">describe</span><span class="p">().</span><span class="n">loc</span><span class="p">[</span><span class="s">'min'</span><span class="p">:</span><span class="s">'max'</span><span class="p">,</span> <span class="s">'MonthlyIncome'</span><span class="p">]</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">'MonthlyIncome'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s">'o'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536479-78a03593-904f-4274-aad3-838450d21ebd.png" alt="" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_nona</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"CityTier"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"MonthlyIncome"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536482-eb11db8c-8a62-4d68-bc55-85315711bf84.png" alt="" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_nona</span><span class="p">[</span><span class="n">train_nona</span><span class="p">[</span><span class="s">'MonthlyIncome'</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">60000</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s">"CityTier"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"MonthlyIncome"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536483-803cfd01-dfdd-4f5c-ad2e-5b489de5516e.png" alt="" /></p>

<h3 id="127designation--monthlyincome">1.2.7.Designation ~ MonthlyIncome</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_nona</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"Designation"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"MonthlyIncome"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536484-67fc9ee7-369e-4b1e-9f7d-ba3d2f4fe0a8.png" alt="" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_nona</span><span class="p">[</span><span class="n">train_nona</span><span class="p">[</span><span class="s">'MonthlyIncome'</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">60000</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s">"Designation"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"MonthlyIncome"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536486-5d6e2e79-bef8-4d05-b8d2-b1a5532dab2e.png" alt="" /></p>

<ul>
  <li>MonthlyIncome의 이상치는 특정한 도시 등급과 직급에서 발견됨.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'MonthlyIncome'</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">40000</span><span class="p">][</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0    2
Name: ProdTaken, dtype: int64
</code></pre></div></div>

<h3 id="128numberoftrips--monthlyincome">1.2.8.NumberOfTrips ~ MonthlyIncome</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_nona</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"NumberOfTrips"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"MonthlyIncome"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536488-4cb52966-2c66-4a6c-8c66-87e6ac14ea64.png" alt="" /></p>

<ul>
  <li>평균 연간 여행 횟수가 0인 사람들의 월 급여의 평균이 가장 높았다. 
꼭 월 급여가 높다고 여행을 많이 다니는 것은 아닌 것을 알 수 있다.</li>
</ul>

<h3 id="129durationofpitch--pitchsatisfactionscore">1.2.9.DurationOfPitch ~ PitchSatisfactionScore</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_enc</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"PitchSatisfactionScore"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"DurationOfPitch"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536489-0ed99141-b2a2-4fc1-b787-92ef18433350.png" alt="" /></p>

<ul>
  <li>두 변수간 큰 상관관계가 없는 것으로 보임</li>
</ul>

<h3 id="1210heatmap">1.2.10.heatmap</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">heatmap</span><span class="p">(</span><span class="n">train_enc</span><span class="p">.</span><span class="nf">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'pearson'</span><span class="p">),</span><span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">'.1f'</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'Blues'</span><span class="p">)</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fac6aeff410&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536493-bd2b7207-610d-43d5-8f87-fb07abf75c7d.png" alt="" /></p>

<h2 id="13heatmap-정보를-기반으로-eda">1.3.heatmap 정보를 기반으로 EDA</h2>

<h3 id="131-monthlyincome--age">1.3.1. MonthlyIncome ~ Age</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">130</span><span class="p">)</span>

<span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'Age'</span><span class="p">],</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'MonthlyIncome'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'Age'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">'MonthlyIncome'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/local/lib/python3.7/dist-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536498-ad06ff9d-d423-412b-9491-701d19a329be.png" alt="" /></p>

<ul>
  <li>나이가 0인 데이터가 확인되고 또 그 중 월 급여가 0이 아닌 데이터가 보인다. 데이터의 오류가 아닐까 싶어 Age데이터를 확인해 봐야겠다.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<div id="df-96ccd95d-add1-488f-9790-de3ec103807f">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
      <th>ProdTaken</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.0</td>
      <td>1</td>
      <td>3</td>
      <td>6.0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>27</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>6.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>5.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0.0</td>
      <td>1</td>
      <td>18591.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>36</td>
      <td>0.0</td>
      <td>1</td>
      <td>2</td>
      <td>14.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>87</th>
      <td>88</td>
      <td>0.0</td>
      <td>1</td>
      <td>2</td>
      <td>8.0</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>18539.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>121</th>
      <td>122</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>35.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>5.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1882</th>
      <td>1883</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>15.0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1888</th>
      <td>1889</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>12.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>2</td>
      <td>2.0</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1914</th>
      <td>1915</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>7.0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1916</th>
      <td>1917</td>
      <td>0.0</td>
      <td>1</td>
      <td>2</td>
      <td>26.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>18669.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1923</th>
      <td>1924</td>
      <td>0.0</td>
      <td>0</td>
      <td>3</td>
      <td>16.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>94 rows × 20 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-96ccd95d-add1-488f-9790-de3ec103807f')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-96ccd95d-add1-488f-9790-de3ec103807f button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-96ccd95d-add1-488f-9790-de3ec103807f');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<div id="df-bbbb24dd-37dc-4ab7-bcac-aa9d67b6b4cc">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>21</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>8.0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>5.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>1</td>
      <td>6.0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1.0</td>
      <td>1</td>
      <td>18464.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>26</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>12.0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>18702.0</td>
    </tr>
    <tr>
      <th>54</th>
      <td>55</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>6.0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>67</th>
      <td>68</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>6.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>95</th>
      <td>96</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>15.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2799</th>
      <td>2800</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>8.0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>5.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>6.0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0.0</td>
      <td>1</td>
      <td>18464.0</td>
    </tr>
    <tr>
      <th>2811</th>
      <td>2812</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>13.0</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>1.0</td>
      <td>0</td>
      <td>5.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0.0</td>
      <td>1</td>
      <td>18578.0</td>
    </tr>
    <tr>
      <th>2834</th>
      <td>2835</td>
      <td>0.0</td>
      <td>1</td>
      <td>3</td>
      <td>14.0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2841</th>
      <td>2842</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>22.0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>5.0</td>
      <td>2</td>
      <td>2.0</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2916</th>
      <td>2917</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>11.0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>132 rows × 19 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bbbb24dd-37dc-4ab7-bcac-aa9d67b6b4cc')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bbbb24dd-37dc-4ab7-bcac-aa9d67b6b4cc button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bbbb24dd-37dc-4ab7-bcac-aa9d67b6b4cc');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'Age'</span><span class="p">],</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'MonthlyIncome'</span><span class="p">],</span><span class="n">hue</span><span class="o">=</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'ProductPitched'</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'Age'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">'MonthlyIncome'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">'ProductPitched'</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/local/lib/python3.7/dist-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536500-5e0d03a6-3bb5-4ec6-b65f-4091efdae84a.png" alt="" /></p>

<h4 id="1311age가-0인-데이터-age-예측">1.3.1.1.Age가 0인 데이터 age 예측</h4>

<ul>
  <li>age가 0일 수는 없다고 생각해서 다른 feature들로 age를 예측해봐야겠다고 생각했다.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>
<span class="n">temp</span>
</code></pre></div></div>

<div id="df-ddae0d7f-3888-4f1d-be15-8984af5afadc">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
      <th>ProdTaken</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>28.0</td>
      <td>0</td>
      <td>1</td>
      <td>10.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>20384.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>34.0</td>
      <td>1</td>
      <td>3</td>
      <td>0.0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>4.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>19599.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>45.0</td>
      <td>0</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>29.0</td>
      <td>0</td>
      <td>1</td>
      <td>7.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>21274.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>42.0</td>
      <td>1</td>
      <td>3</td>
      <td>6.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>19907.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>1951</td>
      <td>28.0</td>
      <td>1</td>
      <td>1</td>
      <td>10.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>2</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>20723.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>1952</td>
      <td>41.0</td>
      <td>1</td>
      <td>3</td>
      <td>8.0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>3.0</td>
      <td>4</td>
      <td>5.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>31595.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>1953</td>
      <td>38.0</td>
      <td>0</td>
      <td>3</td>
      <td>28.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>7.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>21651.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>1954</td>
      <td>28.0</td>
      <td>1</td>
      <td>3</td>
      <td>30.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>5.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>2</td>
      <td>22218.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>1955</td>
      <td>22.0</td>
      <td>0</td>
      <td>1</td>
      <td>9.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>17853.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1861 rows × 20 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ddae0d7f-3888-4f1d-be15-8984af5afadc')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ddae0d7f-3888-4f1d-be15-8984af5afadc button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ddae0d7f-3888-4f1d-be15-8984af5afadc');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">features</span> <span class="o">=</span> <span class="n">temp</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">target</span> <span class="o">=</span> <span class="s">'Age'</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">train_size</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">model_rf</span> <span class="o">=</span> <span class="nc">RandomForestRegressor</span><span class="p">()</span>

<span class="n">model_rf</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">predict</span> <span class="o">=</span> <span class="n">model_rf</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>


</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_test</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1755    54.0
1756    59.0
1757    21.0
1758    43.0
1759    48.0
        ... 
1950    28.0
1951    41.0
1952    38.0
1953    28.0
1954    22.0
Name: Age, Length: 187, dtype: float64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">130</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">predict</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">y_test</span><span class="p">.</span><span class="n">values</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536505-4c00bda4-860b-400e-8b65-91b5530e2ac0.png" alt="" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">mean_absolute_error</span><span class="p">(</span><span class="n">predict</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5.528181818181818
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">temp</span>
</code></pre></div></div>

<div id="df-4ead7b50-a9fb-4aff-8a92-851e68dd97af">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
      <th>ProdTaken</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>14</td>
      <td>0.0</td>
      <td>1</td>
      <td>3</td>
      <td>6.0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>5.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>27</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>6.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>5.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0.0</td>
      <td>1</td>
      <td>18591.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>36</td>
      <td>0.0</td>
      <td>1</td>
      <td>2</td>
      <td>14.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>87</th>
      <td>88</td>
      <td>0.0</td>
      <td>1</td>
      <td>2</td>
      <td>8.0</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>18539.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>121</th>
      <td>122</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>35.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>5.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1882</th>
      <td>1883</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>15.0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1888</th>
      <td>1889</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>12.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>2</td>
      <td>2.0</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1914</th>
      <td>1915</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>7.0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1916</th>
      <td>1917</td>
      <td>0.0</td>
      <td>1</td>
      <td>2</td>
      <td>26.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>18669.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1923</th>
      <td>1924</td>
      <td>0.0</td>
      <td>0</td>
      <td>3</td>
      <td>16.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>94 rows × 20 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4ead7b50-a9fb-4aff-8a92-851e68dd97af')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4ead7b50-a9fb-4aff-8a92-851e68dd97af button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4ead7b50-a9fb-4aff-8a92-851e68dd97af');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>

<span class="n">train_enc</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="s">'Age'</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_rf</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">().</span><span class="nf">sort_index</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>18.0     5
19.0    16
20.0    13
21.0    17
22.0    20
        ..
57.0     9
58.0    11
59.0    14
60.0    12
61.0     3
Name: Age, Length: 135, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'Age'</span><span class="p">],</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'MonthlyIncome'</span><span class="p">],</span><span class="n">hue</span><span class="o">=</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'ProductPitched'</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'Age'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">'MonthlyIncome'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">'ProductPitched'</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/local/lib/python3.7/dist-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536506-f0ece5b4-0f55-45ca-b93b-bf78bec230ed.png" alt="" /></p>

<ul>
  <li>Age 가 0인 데이터가 없어진 것을 확인 할 수있다.</li>
</ul>

<h3 id="132monthlyincome--numberofpersonvisiting">1.3.2.MonthlyIncome ~ NumberOfPersonVisiting</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="s">'NumberOfPersonVisiting'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3    988
2    543
4    412
1     11
5      1
Name: NumberOfPersonVisiting, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'NumberOfPersonVisiting'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">,</span><span class="n">temp</span><span class="p">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'NumberOfPersonVisiting'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">'counts'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536509-4116ef1d-decd-4ad1-b19f-cb935d029919.png" alt="" /></p>

<ul>
  <li>혼자 가거나 5명이서 가는 경우는 거의 없고 2,3,4명이서 가는 경우가 많다</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_enc</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"NumberOfPersonVisiting"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"MonthlyIncome"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536510-886ce79c-e2c5-43e3-a903-81531ae1d208.png" alt="" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">violinplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_enc</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">"NumberOfPersonVisiting"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"MonthlyIncome"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536512-e8329b00-3466-4317-a797-242510ad2ced.png" alt="" /></p>

<ul>
  <li>2,3,4 에는 차이가 크지 않지만 확실히 혼자가는 사람은 월 급여가 낮은 것을 알 수 있다.</li>
</ul>

<h3 id="133monthlyincome--durationofpitch">1.3.3.MonthlyIncome ~ DurationOfPitch</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="s">'DurationOfPitch'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>9.0     199
7.0     126
8.0     122
6.0     116
16.0    114
14.0    112
15.0    105
10.0    103
0.0     102
12.0     85
11.0     83
13.0     83
17.0     75
23.0     41
30.0     39
22.0     36
31.0     34
25.0     32
27.0     31
32.0     30
20.0     29
35.0     29
26.0     27
29.0     27
24.0     27
28.0     25
21.0     24
18.0     23
33.0     22
19.0     18
34.0     18
36.0     15
5.0       3
Name: DurationOfPitch, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">130</span><span class="p">)</span>

<span class="n">sns</span><span class="p">.</span><span class="nf">scatterplot</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'DurationOfPitch'</span><span class="p">],</span><span class="n">train_enc</span><span class="p">[</span><span class="s">'MonthlyIncome'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'DurationOfPitch'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">'MonthlyIncome'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/local/lib/python3.7/dist-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536515-d9c3e1e9-3659-4529-8444-9a7628e94612.png" alt="" /></p>

<ul>
  <li>상관관계를 찾기 힘들어보임.</li>
</ul>

<h1 id="2feature-engineering">2.Feature engineering</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">heatmap</span><span class="p">(</span><span class="n">train_enc</span><span class="p">.</span><span class="nf">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'pearson'</span><span class="p">),</span><span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">'.1f'</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'Blues'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fac6aa35410&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536517-6a270096-611e-4c7e-86a2-558f1107971e.png" alt="" /></p>

<ul>
  <li>새로운 파생변수를 만들고 싶지만 데이터의 타입이 대부분 카테고리형태여서 힘들 것 같다.</li>
</ul>

<h2 id="21drop">2.1.drop</h2>

<ul>
  <li>target과 상관관계가 낮은 feature는 설정X</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">.</span><span class="nf">corr</span><span class="p">()[</span><span class="s">'ProdTaken'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>id                         -0.048933
Age                        -0.136257
TypeofContact              -0.047598
CityTier                    0.085583
DurationOfPitch             0.069795
Occupation                 -0.042101
Gender                      0.019991
NumberOfPersonVisiting      0.006483
NumberOfFollowups           0.102778
ProductPitched             -0.150399
PreferredPropertyStar       0.108886
MaritalStatus               0.169245
NumberOfTrips               0.060995
Passport                    0.293726
PitchSatisfactionScore      0.067736
OwnCar                     -0.040465
NumberOfChildrenVisiting    0.010089
Designation                -0.096041
MonthlyIncome              -0.077508
ProdTaken                   1.000000
Name: ProdTaken, dtype: float64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">.</span><span class="nf">corr</span><span class="p">()[</span><span class="s">'ProdTaken'</span><span class="p">].</span><span class="n">index</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['id', 'Age', 'TypeofContact', 'CityTier', 'DurationOfPitch',
       'Occupation', 'Gender', 'NumberOfPersonVisiting', 'NumberOfFollowups',
       'ProductPitched', 'PreferredPropertyStar', 'MaritalStatus',
       'NumberOfTrips', 'Passport', 'PitchSatisfactionScore', 'OwnCar',
       'NumberOfChildrenVisiting', 'Designation', 'MonthlyIncome',
       'ProdTaken'],
      dtype='object')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Age'</span><span class="p">,</span><span class="s">'CityTier'</span><span class="p">,</span> <span class="s">'DurationOfPitch'</span><span class="p">,</span>
       <span class="s">'Occupation'</span><span class="p">,</span>  <span class="s">'NumberOfFollowups'</span><span class="p">,</span>
       <span class="s">'ProductPitched'</span><span class="p">,</span> <span class="s">'PreferredPropertyStar'</span><span class="p">,</span> <span class="s">'MaritalStatus'</span><span class="p">,</span>
       <span class="s">'NumberOfTrips'</span><span class="p">,</span> <span class="s">'Passport'</span><span class="p">,</span> <span class="s">'PitchSatisfactionScore'</span><span class="p">,</span> <span class="s">'OwnCar'</span><span class="p">,</span>
        <span class="s">'Designation'</span><span class="p">,</span> <span class="s">'MonthlyIncome'</span><span class="p">,</span>
       <span class="s">'ProdTaken'</span><span class="p">]</span>
<span class="n">features</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['Age',
 'CityTier',
 'DurationOfPitch',
 'Occupation',
 'NumberOfFollowups',
 'ProductPitched',
 'PreferredPropertyStar',
 'MaritalStatus',
 'NumberOfTrips',
 'Passport',
 'PitchSatisfactionScore',
 'OwnCar',
 'Designation',
 'MonthlyIncome',
 'ProdTaken']
</code></pre></div></div>

<h2 id="22scaling">2.2.scaling</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div>

<div id="df-ace79a6b-3c2f-4628-8890-3f93de393dd9">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
      <th>ProdTaken</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>28.0</td>
      <td>0</td>
      <td>1</td>
      <td>10.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>20384.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>34.0</td>
      <td>1</td>
      <td>3</td>
      <td>0.0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>4.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>19599.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>45.0</td>
      <td>0</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>29.0</td>
      <td>0</td>
      <td>1</td>
      <td>7.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>21274.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>42.0</td>
      <td>1</td>
      <td>3</td>
      <td>6.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>19907.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ace79a6b-3c2f-4628-8890-3f93de393dd9')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ace79a6b-3c2f-4628-8890-3f93de393dd9 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ace79a6b-3c2f-4628-8890-3f93de393dd9');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="nc">StandardScaler</span><span class="p">()</span>

<span class="n">train_enc</span><span class="p">[[</span><span class="s">'MonthlyIncome'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[[</span><span class="s">'MonthlyIncome'</span><span class="p">]])</span>
<span class="n">train_enc</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div>

<div id="df-4f32cfb6-3a09-4043-8644-f3eaab0c771c">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
      <th>ProdTaken</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>28.0</td>
      <td>0</td>
      <td>1</td>
      <td>10.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>-0.268499</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>34.0</td>
      <td>1</td>
      <td>3</td>
      <td>0.0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>4.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>-0.372240</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>45.0</td>
      <td>0</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>-2.962326</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>29.0</td>
      <td>0</td>
      <td>1</td>
      <td>7.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>-0.150882</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>42.0</td>
      <td>1</td>
      <td>3</td>
      <td>6.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>-0.331537</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4f32cfb6-3a09-4043-8644-f3eaab0c771c')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4f32cfb6-3a09-4043-8644-f3eaab0c771c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4f32cfb6-3a09-4043-8644-f3eaab0c771c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="s">'MonthlyIncome'</span><span class="p">].</span><span class="nf">hist</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fac6ad5add0&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/122070432/216536520-d813293b-f9c1-4b97-82d7-88b5f3de6cf7.png" alt="" /></p>

<h1 id="3모델링을-위한-데이터-전처리">3.모델링을 위한 데이터 전처리</h1>

<h3 id="013추가-결측치-처리-모듈-생성-1">0.1.3.(추가) 결측치 처리 모듈 생성</h3>
<ul>
  <li>0으로 채운 수치형 컬럼의 결측치를 회귀예측 모델로 예측하여 채워넣는 모듈 생성</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesRegressor</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">prod_val</span><span class="p">(</span><span class="n">feature</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
  <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
    <span class="k">return</span> <span class="s">'already processed'</span>
  <span class="n">train_temp</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>

  <span class="n">features</span> <span class="o">=</span> <span class="n">train_temp</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">drop</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
  <span class="n">target</span> <span class="o">=</span> <span class="n">feature</span>

  <span class="n">X</span> <span class="o">=</span> <span class="n">train_temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">train_temp</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>

  <span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">train_size</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
  <span class="n">model_rf</span> <span class="o">=</span> <span class="nc">ExtraTreesRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

  <span class="n">model_rf</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

  <span class="n">train_predict</span> <span class="o">=</span> <span class="n">model_rf</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

  <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s"> MAE: </span><span class="si">{</span><span class="nf">mean_absolute_error</span><span class="p">(</span><span class="n">train_predict</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

  <span class="n">X</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">][</span><span class="n">features</span><span class="p">]</span>

  <span class="n">train_enc</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_enc</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_rf</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

  <span class="n">test_temp</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>

  <span class="n">X</span> <span class="o">=</span> <span class="n">test_temp</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>

  <span class="n">test</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_rf</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

  <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="se">\n</span><span class="s">train set: </span><span class="se">\n</span><span class="si">{</span><span class="n">train_enc</span><span class="p">[</span><span class="n">feature</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">().</span><span class="nf">sort_index</span><span class="p">().</span><span class="nf">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
  <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="se">\n</span><span class="s">test set: </span><span class="se">\n</span><span class="si">{</span><span class="n">test</span><span class="p">[</span><span class="n">feature</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">().</span><span class="nf">sort_index</span><span class="p">().</span><span class="nf">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">'/content/drive/MyDrive/data/여행상품신청/train.csv'</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">'/content/drive/MyDrive/data/여행상품신청/test.csv'</span><span class="p">)</span>
<span class="n">sample_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">'/content/drive/MyDrive/data/여행상품신청/sample_submission.csv'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="31결측치-처리">3.1.결측치 처리</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">handle_na</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">.</span><span class="n">dtypes</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s">'object'</span><span class="p">:</span>
            <span class="c1"># 문자형 칼럼의 경우 'Unknown'을 채워줍니다.
</span>            <span class="n">value</span> <span class="o">=</span> <span class="s">'Unknown'</span>
        <span class="k">elif</span> <span class="n">dtype</span> <span class="o">==</span> <span class="nb">int</span> <span class="ow">or</span> <span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
            <span class="c1"># 수치형 칼럼의 경우 0을 채워줍니다.
</span>            <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">temp</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="nf">fillna</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">temp</span>

<span class="n">train_nona</span> <span class="o">=</span> <span class="nf">handle_na</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>

<span class="c1"># 결측치 처리가 잘 되었는지 확인해 줍니다.
</span><span class="n">train_nona</span><span class="p">.</span><span class="nf">isna</span><span class="p">().</span><span class="nf">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>id                          0
Age                         0
TypeofContact               0
CityTier                    0
DurationOfPitch             0
Occupation                  0
Gender                      0
NumberOfPersonVisiting      0
NumberOfFollowups           0
ProductPitched              0
PreferredPropertyStar       0
MaritalStatus               0
NumberOfTrips               0
Passport                    0
PitchSatisfactionScore      0
OwnCar                      0
NumberOfChildrenVisiting    0
Designation                 0
MonthlyIncome               0
ProdTaken                   0
dtype: int64
</code></pre></div></div>

<h2 id="32문자형-변수-전처리">3.2.문자형 변수 전처리</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_nona</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_nona</span><span class="p">[</span><span class="s">'Gender'</span><span class="p">]</span><span class="o">==</span><span class="s">'Fe Male'</span><span class="p">,</span><span class="s">'Gender'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Female'</span>
<span class="n">test</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="s">'Gender'</span><span class="p">]</span><span class="o">==</span><span class="s">'Fe Male'</span><span class="p">,</span><span class="s">'Gender'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Female'</span>
<span class="n">train_nona</span><span class="p">[</span><span class="s">'Gender'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Male      1207
Female     748
Name: Gender, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># LabelEncoder를 준비해줍니다.
</span><span class="kn">from</span> <span class="n">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="n">encoder</span> <span class="o">=</span> <span class="nc">LabelEncoder</span><span class="p">()</span>

<span class="c1"># LabelEcoder는 학습하는 과정을 필요로 합니다.
</span><span class="n">encoder</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">train_nona</span><span class="p">[</span><span class="s">'TypeofContact'</span><span class="p">])</span>

<span class="c1">#학습된 encoder를 사용하여 문자형 변수를 숫자로 변환해줍니다.
</span><span class="n">encoder</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">train_nona</span><span class="p">[</span><span class="s">'TypeofContact'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([0, 1, 0, ..., 0, 1, 0])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span> <span class="o">=</span> <span class="n">train_nona</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
<span class="n">object_columns</span> <span class="o">=</span> <span class="n">train_nona</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="n">train_nona</span><span class="p">.</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s">'object'</span><span class="p">]</span>
<span class="c1"># 모든 문자형 변수에 대해 encoder를 적용합니다.
</span><span class="k">for</span> <span class="n">o_col</span> <span class="ow">in</span> <span class="n">object_columns</span><span class="p">:</span>
    <span class="n">encoder</span> <span class="o">=</span> <span class="nc">LabelEncoder</span><span class="p">()</span>
    <span class="n">encoder</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[</span><span class="n">o_col</span><span class="p">])</span>
    <span class="n">train_enc</span><span class="p">[</span><span class="n">o_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[</span><span class="n">o_col</span><span class="p">])</span>

<span class="c1"># 결과를 확인합니다.
</span><span class="n">train_enc</span>
</code></pre></div></div>

<div id="df-a1a751fc-f2c3-4359-9c5e-73626287fb98">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
      <th>ProdTaken</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>28.0</td>
      <td>0</td>
      <td>1</td>
      <td>10.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>20384.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>34.0</td>
      <td>1</td>
      <td>3</td>
      <td>0.0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>4.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>19599.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>45.0</td>
      <td>0</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>29.0</td>
      <td>0</td>
      <td>1</td>
      <td>7.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>21274.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>42.0</td>
      <td>1</td>
      <td>3</td>
      <td>6.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>19907.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>1951</td>
      <td>28.0</td>
      <td>1</td>
      <td>1</td>
      <td>10.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>2</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>20723.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>1952</td>
      <td>41.0</td>
      <td>1</td>
      <td>3</td>
      <td>8.0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>3.0</td>
      <td>4</td>
      <td>5.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>31595.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>1953</td>
      <td>38.0</td>
      <td>0</td>
      <td>3</td>
      <td>28.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>7.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>21651.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>1954</td>
      <td>28.0</td>
      <td>1</td>
      <td>3</td>
      <td>30.0</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>5.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>2</td>
      <td>22218.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>1955</td>
      <td>22.0</td>
      <td>0</td>
      <td>1</td>
      <td>9.0</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>17853.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>1955 rows × 20 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a1a751fc-f2c3-4359-9c5e-73626287fb98')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a1a751fc-f2c3-4359-9c5e-73626287fb98 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a1a751fc-f2c3-4359-9c5e-73626287fb98');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 결측치 처리
</span><span class="n">test</span> <span class="o">=</span> <span class="nf">handle_na</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="c1"># 문자형 변수 전처리
</span><span class="k">for</span> <span class="n">o_col</span> <span class="ow">in</span> <span class="n">object_columns</span><span class="p">:</span>
    <span class="n">encoder</span> <span class="o">=</span> <span class="nc">LabelEncoder</span><span class="p">()</span>
    
    <span class="c1"># test 데이터를 이용해 encoder를 학습하는 것은 Data Leakage 입니다! 조심!
</span>    <span class="n">encoder</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">train_nona</span><span class="p">[</span><span class="n">o_col</span><span class="p">])</span>
    
    <span class="c1"># test 데이터는 오로지 transform 에서만 사용되어야 합니다.
</span>    <span class="n">test</span><span class="p">[</span><span class="n">o_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">o_col</span><span class="p">])</span>

<span class="c1"># 결과를 확인합니다.
</span><span class="n">test</span>
</code></pre></div></div>

<div id="df-75deace8-28ff-43ec-97e1-0165baf8e365">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>32.0</td>
      <td>0</td>
      <td>3</td>
      <td>0.0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>5.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>19668.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>46.0</td>
      <td>1</td>
      <td>2</td>
      <td>11.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>20021.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>37.0</td>
      <td>1</td>
      <td>3</td>
      <td>22.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>5.0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0.0</td>
      <td>2</td>
      <td>21334.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>43.0</td>
      <td>1</td>
      <td>1</td>
      <td>36.0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>6.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>3</td>
      <td>6.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>2.0</td>
      <td>2</td>
      <td>22950.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>25.0</td>
      <td>1</td>
      <td>3</td>
      <td>7.0</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>4.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>3</td>
      <td>3.0</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>21880.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2928</th>
      <td>2929</td>
      <td>54.0</td>
      <td>1</td>
      <td>1</td>
      <td>6.0</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>3.0</td>
      <td>4</td>
      <td>3.0</td>
      <td>2</td>
      <td>7.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>32328.0</td>
    </tr>
    <tr>
      <th>2929</th>
      <td>2930</td>
      <td>33.0</td>
      <td>1</td>
      <td>1</td>
      <td>9.0</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>2.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>2</td>
      <td>23733.0</td>
    </tr>
    <tr>
      <th>2930</th>
      <td>2931</td>
      <td>33.0</td>
      <td>0</td>
      <td>1</td>
      <td>31.0</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>23987.0</td>
    </tr>
    <tr>
      <th>2931</th>
      <td>2932</td>
      <td>26.0</td>
      <td>1</td>
      <td>1</td>
      <td>9.0</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>2.0</td>
      <td>0</td>
      <td>5.0</td>
      <td>3</td>
      <td>2.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>22102.0</td>
    </tr>
    <tr>
      <th>2932</th>
      <td>2933</td>
      <td>31.0</td>
      <td>1</td>
      <td>1</td>
      <td>9.0</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>5.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>22830.0</td>
    </tr>
  </tbody>
</table>
<p>2933 rows × 19 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-75deace8-28ff-43ec-97e1-0165baf8e365')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-75deace8-28ff-43ec-97e1-0165baf8e365 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-75deace8-28ff-43ec-97e1-0165baf8e365');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<h2 id="33결측치-처리-모듈-적용">3.3.결측치 처리 모듈 적용</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">prod_val</span><span class="p">(</span><span class="s">'Age'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Age MAE: 5.071390374331551

train set: 
18.0     5
19.0    16
20.0    13
Name: Age, dtype: int64

test set: 
18.0     9
19.0    16
20.0    25
Name: Age, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">train_enc</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([28., 34., 45., 29., 42., 32., 43., 36., 35., 31., 49., 33., 52.,
       22., 50., 23., 41., 37., 40., 56., 54., 39., 20., 38., 46., 27.,
       25., 26., 24., 30., 21., 51., 47., 55., 44., 53., 48., 18., 57.,
       60., 59., 19., 58., 61.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">prod_val</span><span class="p">(</span><span class="s">'MonthlyIncome'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MonthlyIncome MAE: 1205.1359677419355

train set: 
1000.00     1
14781.04    1
16009.00    1
Name: MonthlyIncome, dtype: int64

test set: 
2196.853333     1
4678.000000     1
14921.480000    1
Name: MonthlyIncome, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">prod_val</span><span class="p">(</span><span class="s">'DurationOfPitch'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DurationOfPitch MAE: 6.203512544802866

train set: 
5.0      3
6.0    116
7.0    126
Name: DurationOfPitch, dtype: int64

test set: 
5.0      3
6.0    191
7.0    216
Name: DurationOfPitch, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="s">'DurationOfPitch'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'DurationOfPitch'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="s">'DurationOfPitch'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'DurationOfPitch'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="s">'DurationOfPitch'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([ 16.,  11.,  22.,  36.,   7.,   8.,   6.,  29.,   9.,  12.,  13.,
        17.,  15.,  10.,  14.,  35.,  24.,  31.,  21.,  19.,  32.,  27.,
        18.,  33.,  30.,  26.,  34.,  23.,  20.,  28.,  25., 126.,   5.,
       127.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">prod_val</span><span class="p">(</span><span class="s">'NumberOfTrips'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NumberOfTrips MAE: 1.2843333333333333

train set: 
1.000000    234
1.963333      1
2.000000    594
Name: NumberOfTrips, dtype: int64

test set: 
1.000000    386
2.000000    870
2.856667      1
Name: NumberOfTrips, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="s">'NumberOfTrips'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'NumberOfTrips'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="s">'NumberOfTrips'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'NumberOfTrips'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="s">'NumberOfTrips'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([ 1.,  5.,  6.,  3.,  7.,  4.,  2.,  8., 22., 21., 20.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">prod_val</span><span class="p">(</span><span class="s">'NumberOfFollowups'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NumberOfFollowups MAE: 0.605094017094017

train set: 
1.000000    74
2.000000    89
2.436667     1
Name: NumberOfFollowups, dtype: int64

test set: 
1.000000    102
2.000000    140
2.706667      1
Name: NumberOfFollowups, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="s">'NumberOfFollowups'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'NumberOfFollowups'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="s">'NumberOfFollowups'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'NumberOfFollowups'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="s">'NumberOfFollowups'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([5., 3., 4., 6., 1., 2.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">prod_val</span><span class="p">(</span><span class="s">'PreferredPropertyStar'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PreferredPropertyStar MAE: 0.6105299145299146

train set: 
3.000000    1212
3.126667       1
3.353333       1
Name: PreferredPropertyStar, dtype: int64

test set: 
3.000000    1781
3.033333       1
3.100000       1
Name: PreferredPropertyStar, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="s">'PreferredPropertyStar'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'PreferredPropertyStar'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="s">'PreferredPropertyStar'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'PreferredPropertyStar'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="s">'PreferredPropertyStar'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([3., 4., 5.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">prod_val</span><span class="p">(</span><span class="s">'NumberOfChildrenVisiting'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NumberOfChildrenVisiting MAE: 0.5187938596491228

train set: 
1.000000    1099
1.003333       6
1.030000       1
Name: NumberOfChildrenVisiting, dtype: int64

test set: 
1.000000    1712
1.003333       3
1.043333       1
Name: NumberOfChildrenVisiting, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="s">'NumberOfChildrenVisiting'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'NumberOfChildrenVisiting'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="s">'NumberOfChildrenVisiting'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'NumberOfChildrenVisiting'</span><span class="p">].</span><span class="nf">round</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="s">'NumberOfChildrenVisiting'</span><span class="p">].</span><span class="nf">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([1., 2., 3.])
</code></pre></div></div>

<h2 id="33모듈대체-age가-0인-데이터-age-예측">3.3.(모듈대체) Age가 0인 데이터 age 예측</h2>

<ul>
  <li>age의 결측치를 0으로 채웠었는데 다른 feature들로 age를 예측해봐야겠다고 생각했다.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># temp = train_enc[train_enc['Age']!=0]
# temp.head()
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># features = temp.columns[2:-1]
# target = 'Age'
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># from sklearn.ensemble import RandomForestRegressor
# from sklearn.model_selection import train_test_split
# from sklearn.metrics import mean_absolute_error
</span>
<span class="c1"># X = temp[features]
# y = temp[target]
</span>
<span class="c1"># X_train,X_test,y_train,y_test = train_test_split(X,y,train_size=0.9,shuffle=False)
# model_rf = ExtraTreesRegressor(n_estimators=500)
</span>
<span class="c1"># model_rf.fit(X_train,y_train)
</span>
<span class="c1"># predict = model_rf.predict(X_test)
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># mean_absolute_error(predict,y_test)
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># temp = train_enc[train_enc['Age']==0]
# temp.head()
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># X = temp[features]
</span>
<span class="c1"># train_enc.loc[train_enc['Age']==0,'Age'] = model_rf.predict(X)
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># train_enc['Age'].value_counts().sort_index()
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># temp = test[test['Age']==0]
# temp.head()
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># X = temp[features]
</span>
<span class="c1"># test.loc[test['Age']==0,'Age'] = model_rf.predict(X)
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># test['Age'].value_counts().sort_index()
</span></code></pre></div></div>

<h2 id="34모듈대체-monthly-income-결측치-예측">3.4.(모듈대체) Monthly Income 결측치 예측</h2>
<ul>
  <li>Age와 같은 방법으로 Monthly Income을 예측해보자</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># temp = train_enc[train_enc['MonthlyIncome']!=0]
# temp.head()
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># features = temp.columns[1:-1].drop('MonthlyIncome')
# target = 'MonthlyIncome'
# features
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># from sklearn.ensemble import ExtraTreesRegressor
</span>
<span class="c1"># X = temp[features]
# y = temp[target]
</span>
<span class="c1"># X_train,X_test,y_train,y_test = train_test_split(X,y,train_size=0.9,shuffle=False)
# model_rf = ExtraTreesRegressor(n_estimators=500)
</span>
<span class="c1"># model_rf.fit(X_train,y_train)
</span>
<span class="c1"># predict = model_rf.predict(X_test)
# mean_absolute_error(predict,y_test)
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># temp = train_enc[train_enc['MonthlyIncome']==0]
# temp.head()
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># X = temp[features]
</span>
<span class="c1"># train_enc.loc[train_enc['MonthlyIncome']==0,'MonthlyIncome'] = model_rf.predict(X)
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># train_enc['MonthlyIncome'].value_counts().sort_index()
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># temp = test[test['MonthlyIncome']==0]
# temp.head()
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># X = temp[features]
</span>
<span class="c1"># test.loc[test['MonthlyIncome']==0,'MonthlyIncome'] = model_rf.predict(X)
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># test['MonthlyIncome'].value_counts().sort_index()
</span></code></pre></div></div>

<h2 id="34scaling">3.4.scaling</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="n">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="nc">StandardScaler</span><span class="p">()</span>
<span class="n">min_scaler</span> <span class="o">=</span> <span class="nc">MinMaxScaler</span><span class="p">()</span>

<span class="n">train_enc</span><span class="p">[[</span><span class="s">'MonthlyIncome'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[[</span><span class="s">'MonthlyIncome'</span><span class="p">]])</span>
<span class="n">test</span><span class="p">[[</span><span class="s">'MonthlyIncome'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">test</span><span class="p">[[</span><span class="s">'MonthlyIncome'</span><span class="p">]])</span>

<span class="n">train_enc</span><span class="p">[[</span><span class="s">'Age'</span><span class="p">,</span><span class="s">'DurationOfPitch'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">min_scaler</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">train_enc</span><span class="p">[[</span><span class="s">'Age'</span><span class="p">,</span><span class="s">'DurationOfPitch'</span><span class="p">]])</span>
<span class="n">test</span><span class="p">[[</span><span class="s">'Age'</span><span class="p">,</span><span class="s">'DurationOfPitch'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">min_scaler</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">test</span><span class="p">[[</span><span class="s">'Age'</span><span class="p">,</span><span class="s">'DurationOfPitch'</span><span class="p">]])</span>

<span class="n">train_enc</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div>

<div id="df-227d7b8c-32be-442d-97c9-152a68bfb78e">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>Age</th>
      <th>TypeofContact</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>Gender</th>
      <th>NumberOfPersonVisiting</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>NumberOfChildrenVisiting</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
      <th>ProdTaken</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.232558</td>
      <td>0</td>
      <td>1</td>
      <td>0.161290</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>-0.543896</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.372093</td>
      <td>1</td>
      <td>3</td>
      <td>0.516129</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>4.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>-0.684698</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.627907</td>
      <td>0</td>
      <td>1</td>
      <td>0.322581</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>-0.697951</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.255814</td>
      <td>0</td>
      <td>1</td>
      <td>0.064516</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>-0.384262</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.558140</td>
      <td>1</td>
      <td>3</td>
      <td>0.032258</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>1.0</td>
      <td>2</td>
      <td>-0.629453</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-227d7b8c-32be-442d-97c9-152a68bfb78e')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-227d7b8c-32be-442d-97c9-152a68bfb78e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-227d7b8c-32be-442d-97c9-152a68bfb78e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<h1 id="4모델링">4.모델링</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Age'</span><span class="p">,</span><span class="s">'CityTier'</span><span class="p">,</span> <span class="s">'DurationOfPitch'</span><span class="p">,</span>
       <span class="s">'Occupation'</span><span class="p">,</span>  <span class="s">'NumberOfFollowups'</span><span class="p">,</span>
       <span class="s">'ProductPitched'</span><span class="p">,</span> <span class="s">'PreferredPropertyStar'</span><span class="p">,</span> <span class="s">'MaritalStatus'</span><span class="p">,</span>
       <span class="s">'NumberOfTrips'</span><span class="p">,</span> <span class="s">'Passport'</span><span class="p">,</span> <span class="s">'PitchSatisfactionScore'</span><span class="p">,</span> <span class="s">'OwnCar'</span><span class="p">,</span>
        <span class="s">'Designation'</span><span class="p">,</span> <span class="s">'MonthlyIncome'</span><span class="p">]</span>
<span class="n">features</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['Age',
 'CityTier',
 'DurationOfPitch',
 'Occupation',
 'NumberOfFollowups',
 'ProductPitched',
 'PreferredPropertyStar',
 'MaritalStatus',
 'NumberOfTrips',
 'Passport',
 'PitchSatisfactionScore',
 'OwnCar',
 'Designation',
 'MonthlyIncome']
</code></pre></div></div>

<h2 id="41randomforestclassifier">4.1.RandomForestClassifier</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">train_size</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">rf_model</span> <span class="o">=</span> <span class="nc">RandomForestClassifier</span><span class="p">()</span>

<span class="n">rf_model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred_rf</span> <span class="o">=</span> <span class="n">rf_model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">accuracy_score</span><span class="p">(</span><span class="n">y_pred_rf</span><span class="p">,</span><span class="n">y_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.8826530612244898
</code></pre></div></div>

<h2 id="42xgboost">4.2.Xgboost</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">train_size</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">xgb_model</span> <span class="o">=</span> <span class="nc">XGBClassifier</span><span class="p">()</span>

<span class="n">xgb_model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred_xgb</span> <span class="o">=</span> <span class="n">xgb_model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">accuracy_score</span><span class="p">(</span><span class="n">y_pred_xgb</span><span class="p">,</span><span class="n">y_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.8673469387755102
</code></pre></div></div>

<h2 id="43catboost">4.3.catboost</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">catboost</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span>
</code></pre></div></div>

<div id="df-2d465ff9-cb36-4dc1-8bf9-5cefa56320d7">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.232558</td>
      <td>1</td>
      <td>0.161290</td>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>-0.543896</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.372093</td>
      <td>3</td>
      <td>0.516129</td>
      <td>3</td>
      <td>4.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>2</td>
      <td>-0.684698</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.627907</td>
      <td>1</td>
      <td>0.322581</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>-0.697951</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.255814</td>
      <td>1</td>
      <td>0.064516</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>4.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>-0.384262</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.558140</td>
      <td>3</td>
      <td>0.032258</td>
      <td>2</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>-0.629453</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>0.232558</td>
      <td>1</td>
      <td>0.161290</td>
      <td>3</td>
      <td>5.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>2</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>-0.483092</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>0.534884</td>
      <td>3</td>
      <td>0.096774</td>
      <td>2</td>
      <td>3.0</td>
      <td>4</td>
      <td>5.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>1.466964</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>0.465116</td>
      <td>3</td>
      <td>0.741935</td>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>7.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>-0.316641</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>0.232558</td>
      <td>3</td>
      <td>0.806452</td>
      <td>3</td>
      <td>5.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>3.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>-0.214941</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>0.093023</td>
      <td>1</td>
      <td>0.129032</td>
      <td>2</td>
      <td>4.0</td>
      <td>0</td>
      <td>3.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>-0.997869</td>
    </tr>
  </tbody>
</table>
<p>1955 rows × 14 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-2d465ff9-cb36-4dc1-8bf9-5cefa56320d7')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-2d465ff9-cb36-4dc1-8bf9-5cefa56320d7 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-2d465ff9-cb36-4dc1-8bf9-5cefa56320d7');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cat_features</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">[</span><span class="n">features</span><span class="p">].</span><span class="nf">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1955 entries, 0 to 1954
Data columns (total 14 columns):
 #   Column                  Non-Null Count  Dtype  
---  ------                  --------------  -----  
 0   Age                     1955 non-null   float64
 1   CityTier                1955 non-null   int64  
 2   DurationOfPitch         1955 non-null   float64
 3   Occupation              1955 non-null   int64  
 4   NumberOfFollowups       1955 non-null   float64
 5   ProductPitched          1955 non-null   int64  
 6   PreferredPropertyStar   1955 non-null   float64
 7   MaritalStatus           1955 non-null   int64  
 8   NumberOfTrips           1955 non-null   float64
 9   Passport                1955 non-null   int64  
 10  PitchSatisfactionScore  1955 non-null   int64  
 11  OwnCar                  1955 non-null   int64  
 12  Designation             1955 non-null   int64  
 13  MonthlyIncome           1955 non-null   float64
dtypes: float64(6), int64(8)
memory usage: 214.0 KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">.</span><span class="nf">astype</span><span class="p">({</span><span class="s">'DurationOfPitch'</span><span class="p">:</span><span class="s">'int'</span><span class="p">,</span><span class="s">'NumberOfFollowups'</span><span class="p">:</span><span class="s">'int'</span><span class="p">,</span><span class="s">'PreferredPropertyStar'</span><span class="p">:</span><span class="s">'int'</span><span class="p">,</span><span class="s">'NumberOfTrips'</span><span class="p">:</span><span class="s">'int'</span><span class="p">})</span>
<span class="n">train_enc</span><span class="p">[</span><span class="n">features</span><span class="p">].</span><span class="n">dtypes</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Age                       float64
CityTier                    int64
DurationOfPitch             int64
Occupation                  int64
NumberOfFollowups           int64
ProductPitched              int64
PreferredPropertyStar       int64
MaritalStatus               int64
NumberOfTrips               int64
Passport                    int64
PitchSatisfactionScore      int64
OwnCar                      int64
Designation                 int64
MonthlyIncome             float64
dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">catboost</span> <span class="kn">import</span> <span class="n">CatBoostClassifier</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">train_size</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">cat_model</span> <span class="o">=</span> <span class="nc">CatBoostClassifier</span><span class="p">()</span>

<span class="n">cat_model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span>
          <span class="n">eval_set</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">),</span>
          <span class="n">cat_features</span><span class="o">=</span><span class="n">cat_features</span><span class="p">,</span>
          <span class="n">use_best_model</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
          <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span>
          <span class="p">)</span>

<span class="n">y_pred_cat</span> <span class="o">=</span> <span class="n">cat_model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="nf">accuracy_score</span><span class="p">(</span><span class="n">y_pred_cat</span><span class="p">,</span><span class="n">y_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.8826530612244898
</code></pre></div></div>

<h2 id="44lightgbm">4.4.LightGBM</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">lightgbm</span> <span class="kn">import</span> <span class="n">LGBMClassifier</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">train_size</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">lgbm_model</span> <span class="o">=</span> <span class="nc">LGBMClassifier</span><span class="p">()</span>

<span class="n">lgbm_model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred_lgbm</span> <span class="o">=</span> <span class="n">lgbm_model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">accuracy_score</span><span class="p">(</span><span class="n">y_pred_lgbm</span><span class="p">,</span><span class="n">y_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.8724489795918368
</code></pre></div></div>

<h2 id="45extratrees">4.5.ExtraTrees</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesClassifier</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">train_size</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">et_model</span> <span class="o">=</span> <span class="nc">ExtraTreesClassifier</span><span class="p">()</span>

<span class="n">et_model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred_et</span> <span class="o">=</span> <span class="n">et_model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">accuracy_score</span><span class="p">(</span><span class="n">y_pred_et</span><span class="p">,</span><span class="n">y_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.8979591836734694
</code></pre></div></div>

<h1 id="5모델-앙상블">5.모델 앙상블</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_enc</span><span class="p">.</span><span class="n">dtypes</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>id                            int64
Age                         float64
TypeofContact                 int64
CityTier                      int64
DurationOfPitch               int64
Occupation                    int64
Gender                        int64
NumberOfPersonVisiting        int64
NumberOfFollowups             int64
ProductPitched                int64
PreferredPropertyStar         int64
MaritalStatus                 int64
NumberOfTrips                 int64
Passport                      int64
PitchSatisfactionScore        int64
OwnCar                        int64
NumberOfChildrenVisiting    float64
Designation                   int64
MonthlyIncome               float64
ProdTaken                     int64
dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="n">features</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">train_enc</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span>
</code></pre></div></div>

<div id="df-70ce2c92-ee70-4dcb-b58e-d886df95dc91">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>CityTier</th>
      <th>DurationOfPitch</th>
      <th>Occupation</th>
      <th>NumberOfFollowups</th>
      <th>ProductPitched</th>
      <th>PreferredPropertyStar</th>
      <th>MaritalStatus</th>
      <th>NumberOfTrips</th>
      <th>Passport</th>
      <th>PitchSatisfactionScore</th>
      <th>OwnCar</th>
      <th>Designation</th>
      <th>MonthlyIncome</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.232558</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>-0.543896</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.372093</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>2</td>
      <td>-0.684698</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.627907</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>-0.697951</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.255814</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>-0.384262</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.558140</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>2</td>
      <td>-0.629453</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1950</th>
      <td>0.232558</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>-0.483092</td>
    </tr>
    <tr>
      <th>1951</th>
      <td>0.534884</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>1.466964</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>0.465116</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>-0.316641</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>0.232558</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>-0.214941</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>0.093023</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>-0.997869</td>
    </tr>
  </tbody>
</table>
<p>1955 rows × 14 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-70ce2c92-ee70-4dcb-b58e-d886df95dc91')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-70ce2c92-ee70-4dcb-b58e-d886df95dc91 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-70ce2c92-ee70-4dcb-b58e-d886df95dc91');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">rf</span> <span class="o">=</span> <span class="nc">RandomForestClassifier</span><span class="p">()</span>

<span class="n">models</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">rf</span><span class="p">)</span>

<span class="n">xgb</span> <span class="o">=</span> <span class="nc">XGBClassifier</span><span class="p">()</span>

<span class="n">models</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">xgb</span><span class="p">)</span>

<span class="n">cat</span> <span class="o">=</span> <span class="nc">CatBoostClassifier</span><span class="p">()</span>

<span class="n">models</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>

<span class="n">lgbm</span> <span class="o">=</span> <span class="nc">LGBMClassifier</span><span class="p">()</span>

<span class="n">models</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">lgbm</span><span class="p">)</span>

<span class="n">et</span> <span class="o">=</span> <span class="nc">ExtraTreesClassifier</span><span class="p">()</span>

<span class="n">models</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">et</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">param_rf</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'max_depth'</span><span class="p">:</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span><span class="bp">None</span><span class="p">],</span>
    <span class="s">'min_samples_leaf'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
    <span class="s">'min_samples_split'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="s">'n_estimators'</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span><span class="mi">700</span><span class="p">],</span>
    <span class="s">'criterion'</span><span class="p">:</span> <span class="p">[</span><span class="s">'gini'</span><span class="p">,</span><span class="s">'entropy'</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">param_xgb</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'learning_rate'</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
        <span class="s">'min_child_weight'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="s">'n_estimators'</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">700</span><span class="p">],</span>
        <span class="s">'gamma'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="c1">#'subsample': [0.6,  1.0],
</span>        <span class="c1">#'colsample_bytree': [0.6, 1.0],
</span>        <span class="s">'max_depth'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="p">}</span>

<span class="n">param_cat</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1">#'iterations':[600,None],
</span>        <span class="s">'learning_rate'</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span><span class="bp">None</span><span class="p">],</span>
        <span class="s">'depth'</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span><span class="bp">None</span><span class="p">],</span>
        <span class="s">'l2_leaf_reg'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="bp">None</span><span class="p">],</span>
        <span class="s">'cat_features'</span> <span class="p">:</span> <span class="p">[</span><span class="n">cat_features</span><span class="p">]</span>
        
        <span class="p">}</span>

<span class="n">param_lgbm</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'learning_rate'</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
    <span class="s">'n_estimators'</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span>  <span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="c1">#'num_leaves': [6,16,31], # large num_leaves helps improve accuracy but might lead to over-fitting
</span>    <span class="s">'boosting_type'</span> <span class="p">:</span> <span class="p">[</span><span class="s">'dart'</span><span class="p">,</span><span class="s">'gbdt'</span><span class="p">],</span> <span class="c1"># for better accuracy -&gt; try dart ['gbdt'] drop함 
</span>    <span class="s">'objective'</span> <span class="p">:</span> <span class="p">[</span><span class="s">'binary'</span><span class="p">],</span>
    <span class="c1">#'colsample_bytree' : [0.64, 0.66,1],
</span>    <span class="c1">#'subsample' : [0.7,0.75,1],
</span>    <span class="s">'reg_alpha'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="s">'reg_lambda'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">}</span>
<span class="n">param_et</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'max_depth'</span><span class="p">:</span> <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span><span class="bp">None</span><span class="p">],</span>
    <span class="s">'min_samples_leaf'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
    <span class="c1">#'min_samples_split': [2,10, 12],
</span>    <span class="s">'n_estimators'</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span>  <span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span><span class="mi">700</span><span class="p">],</span>
    <span class="s">'criterion'</span><span class="p">:</span> <span class="p">[</span><span class="s">'gini'</span><span class="p">,</span><span class="s">'entropy'</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">params</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">param_rf</span><span class="p">)</span>
<span class="n">params</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">param_xgb</span><span class="p">)</span>
<span class="n">params</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">param_cat</span><span class="p">)</span>
<span class="n">params</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">param_lgbm</span><span class="p">)</span>
<span class="n">params</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">param_et</span><span class="p">)</span>
<span class="n">params</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[{'max_depth': [80, 100, None],
  'min_samples_leaf': [1, 3],
  'min_samples_split': [2, 8, 10],
  'n_estimators': [100, 300, 500, 700],
  'criterion': ['gini', 'entropy']},
 {'learning_rate': [0.05, 0.1],
  'min_child_weight': [1, 5, 10],
  'n_estimators': [100, 300, 500, 700],
  'gamma': [0, 0.5, 1],
  'max_depth': [3, 4, 5]},
 {'learning_rate': [0.05, 0.1, None],
  'depth': [4, 6, None],
  'l2_leaf_reg': [1, 3, 5, None],
  'cat_features': [[1, 3, 10, 11, 12]]},
 {'learning_rate': [0.05, 0.1],
  'n_estimators': [100, 300, 500],
  'boosting_type': ['dart', 'gbdt'],
  'objective': ['binary'],
  'reg_alpha': [1, 1.2, 0],
  'reg_lambda': [1, 1.4, 0]},
 {'max_depth': [80, 90, 100, None],
  'min_samples_leaf': [1, 2, 3],
  'n_estimators': [100, 300, 500, 700],
  'criterion': ['gini', 'entropy']}]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># best_models = {}
</span>
<span class="c1"># models = GridSearchCV(models[0],param_grid = params[0], cv=7, return_train_score = True, verbose=2)
</span>
<span class="c1"># models.fit(X,y)
</span>
<span class="c1"># best_models[0] = models[0].best_estimator_
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># models = GridSearchCV(models[1],param_grid = params[1], cv=7, return_train_score = True, verbose=2)
</span>
<span class="c1"># models.fit(X,y)
</span>
<span class="c1"># best_models[1] = models[1].best_estimator_
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># models = GridSearchCV(models[2],param_grid = params[2], cv=7, return_train_score = True, verbose=10)
</span>
<span class="c1"># models.fit(X,y)
</span>
<span class="c1"># best_models[2] = models[2].best_estimator_
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># models = GridSearchCV(models[3],param_grid = params[3], cv=7, return_train_score = True, verbose=2)
</span>
<span class="c1"># models.fit(X,y)
</span>
<span class="c1"># best_models[3] = models[3].best_estimator_
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># models = GridSearchCV(models[4],param_grid = params[4], cv=7, return_train_score = True, verbose=2)
</span>
<span class="c1"># models.fit(X,y)
</span>
<span class="c1"># best_models[4] = models[4].best_estimator_
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">best_models</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">model</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
  <span class="n">model</span> <span class="o">=</span> <span class="nc">GridSearchCV</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">param_grid</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">return_train_score</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

  <span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

  <span class="n">best_models</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">best_estimator_</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="nf">astype</span><span class="p">({</span><span class="s">'DurationOfPitch'</span><span class="p">:</span><span class="s">'int'</span><span class="p">,</span><span class="s">'NumberOfFollowups'</span><span class="p">:</span><span class="s">'int'</span><span class="p">,</span><span class="s">'PreferredPropertyStar'</span><span class="p">:</span><span class="s">'int'</span><span class="p">,</span><span class="s">'NumberOfTrips'</span><span class="p">:</span><span class="s">'int'</span><span class="p">})</span>
<span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">].</span><span class="n">dtypes</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Age                       float64
CityTier                    int64
DurationOfPitch             int64
Occupation                  int64
NumberOfFollowups           int64
ProductPitched              int64
PreferredPropertyStar       int64
MaritalStatus               int64
NumberOfTrips               int64
Passport                    int64
PitchSatisfactionScore      int64
OwnCar                      int64
Designation                 int64
MonthlyIncome             float64
dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">best_models</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{0: RandomForestClassifier(n_estimators=700),
 1: XGBClassifier(learning_rate=0.05, max_depth=5, n_estimators=700),
 2: &lt;catboost.core.CatBoostClassifier at 0x7f2430a31e90&gt;,
 3: LGBMClassifier(n_estimators=500, objective='binary', reg_alpha=0, reg_lambda=0),
 4: ExtraTreesClassifier(max_depth=100, n_estimators=300)}
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pred0</span> <span class="o">=</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">pred1</span> <span class="o">=</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">pred2</span> <span class="o">=</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nf">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">pred3</span> <span class="o">=</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nf">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">pred4</span> <span class="o">=</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="nf">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="s">'pred0'</span><span class="p">:</span><span class="n">pred0</span><span class="p">,</span><span class="s">'pred1'</span><span class="p">:</span><span class="n">pred1</span><span class="p">,</span><span class="s">'pred2'</span><span class="p">:</span><span class="n">pred2</span><span class="p">,</span><span class="s">'pred3'</span><span class="p">:</span><span class="n">pred3</span><span class="p">,</span><span class="s">'pred4'</span><span class="p">:</span><span class="n">pred4</span><span class="p">})</span>
<span class="n">pred</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div>

<div id="df-67bf7451-851a-4e38-b999-b7cda7fea34c">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pred0</th>
      <th>pred1</th>
      <th>pred2</th>
      <th>pred3</th>
      <th>pred4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-67bf7451-851a-4e38-b999-b7cda7fea34c')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-67bf7451-851a-4e38-b999-b7cda7fea34c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-67bf7451-851a-4e38-b999-b7cda7fea34c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pred</span>
</code></pre></div></div>

<div id="df-41a58e76-0ee4-4929-8bb1-8b7ef0580e4d">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pred0</th>
      <th>pred1</th>
      <th>pred2</th>
      <th>pred3</th>
      <th>pred4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2928</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2929</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2930</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2931</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2932</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2933 rows × 5 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-41a58e76-0ee4-4929-8bb1-8b7ef0580e4d')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-41a58e76-0ee4-4929-8bb1-8b7ef0580e4d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-41a58e76-0ee4-4929-8bb1-8b7ef0580e4d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pred</span><span class="p">[</span><span class="s">'pred3'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0    2511
1     422
Name: pred3, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pred</span><span class="p">[</span><span class="s">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred</span><span class="p">.</span><span class="nf">mode</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">pred</span>
</code></pre></div></div>

<div id="df-741fa627-7e70-4b27-a38c-206057f0e539">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pred0</th>
      <th>pred1</th>
      <th>pred2</th>
      <th>pred3</th>
      <th>pred4</th>
      <th>pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2928</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2929</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2930</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2931</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2932</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2933 rows × 6 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-741fa627-7e70-4b27-a38c-206057f0e539')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-741fa627-7e70-4b27-a38c-206057f0e539 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-741fa627-7e70-4b27-a38c-206057f0e539');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pred</span><span class="p">[</span><span class="n">pred</span><span class="p">[</span><span class="s">'pred4'</span><span class="p">]</span><span class="o">!=</span> <span class="n">pred</span><span class="p">[</span><span class="s">'pred'</span><span class="p">]]</span>
</code></pre></div></div>

<div id="df-6204fc36-ae68-4e56-868a-48b90283b5d5">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pred0</th>
      <th>pred1</th>
      <th>pred2</th>
      <th>pred3</th>
      <th>pred4</th>
      <th>pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>70</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>83</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>114</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2830</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2869</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2890</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2908</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2909</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>118 rows × 6 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6204fc36-ae68-4e56-868a-48b90283b5d5')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6204fc36-ae68-4e56-868a-48b90283b5d5 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6204fc36-ae68-4e56-868a-48b90283b5d5');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sample_submission</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="s">'pred'</span><span class="p">]</span>
<span class="n">sample_submission</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="s">'submission1.csv'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sample_submission</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="s">'pred4'</span><span class="p">]</span>
<span class="n">sample_submission</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="s">'submission3.csv'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pred0</span> <span class="o">=</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">pred1</span> <span class="o">=</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">pred2</span> <span class="o">=</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">pred3</span> <span class="o">=</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">pred4</span> <span class="o">=</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">pred0</span><span class="o">+</span><span class="n">pred1</span><span class="o">+</span><span class="n">pred2</span><span class="o">+</span><span class="n">pred3</span><span class="o">+</span><span class="n">pred4</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="n">pred</span><span class="p">.</span><span class="nf">head</span><span class="p">()</span>
</code></pre></div></div>

<div id="df-862de30b-c3ff-45a5-847c-065b6c884085">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.278279</td>
      <td>0.921721</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.971699</td>
      <td>0.228301</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.168868</td>
      <td>0.031132</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.053194</td>
      <td>0.146806</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.285364</td>
      <td>3.914636</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-862de30b-c3ff-45a5-847c-065b6c884085')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-862de30b-c3ff-45a5-847c-065b6c884085 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-862de30b-c3ff-45a5-847c-065b6c884085');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">pred</span><span class="p">[</span><span class="s">'pred'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">pred</span><span class="p">),</span><span class="n">axis</span> <span class="o">=</span><span class="mi">1</span> <span class="p">))</span>
<span class="n">pred</span>
</code></pre></div></div>

<div id="df-52cb9b56-350d-427a-a15c-f7a60ba7281a">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.278279</td>
      <td>0.921721</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.971699</td>
      <td>0.228301</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.168868</td>
      <td>0.031132</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.053194</td>
      <td>0.146806</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.285364</td>
      <td>3.914636</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2928</th>
      <td>4.167008</td>
      <td>0.032992</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2929</th>
      <td>4.162987</td>
      <td>0.037013</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2930</th>
      <td>3.921309</td>
      <td>0.278691</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2931</th>
      <td>3.899447</td>
      <td>0.300553</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2932</th>
      <td>4.135267</td>
      <td>0.064733</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2933 rows × 3 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-52cb9b56-350d-427a-a15c-f7a60ba7281a')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-52cb9b56-350d-427a-a15c-f7a60ba7281a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-52cb9b56-350d-427a-a15c-f7a60ba7281a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sample_submission</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="s">'pred'</span><span class="p">]</span>
<span class="n">sample_submission</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="s">'submission2.csv'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">estimators</span> <span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s">'rf'</span><span class="p">,</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <span class="p">(</span><span class="s">'xgb'</span><span class="p">,</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
    <span class="p">(</span><span class="s">'cat'</span><span class="p">,</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
    <span class="p">(</span><span class="s">'lgbm'</span><span class="p">,</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
    <span class="p">(</span><span class="s">'et'</span><span class="p">,</span> <span class="n">best_models</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">VotingClassifier</span>

<span class="n">model</span> <span class="o">=</span> <span class="nc">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span><span class="p">,</span> <span class="n">voting</span><span class="o">=</span><span class="s">'soft'</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([0, 0, 0, ..., 0, 0, 0])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nf">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.0
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sample_submission</span><span class="p">[</span><span class="s">'ProdTaken'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">features</span><span class="p">]))</span>
<span class="n">sample_submission</span>
</code></pre></div></div>

<div id="df-0209f350-6b5b-462f-88ec-6d2b3180b010">
    <div class="colab-df-container">
      <div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>ProdTaken</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2928</th>
      <td>2929</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2929</th>
      <td>2930</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2930</th>
      <td>2931</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2931</th>
      <td>2932</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2932</th>
      <td>2933</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2933 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0209f350-6b5b-462f-88ec-6d2b3180b010')" title="Convert this dataframe to an interactive table." style="display:none;">

  &lt;svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px"&gt;
    <path d="M0 0h24v24H0V0z" fill="none" />
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z" /><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z" />
  &lt;/svg&gt;
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0209f350-6b5b-462f-88ec-6d2b3180b010 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0209f350-6b5b-462f-88ec-6d2b3180b010');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sample_submission</span><span class="p">.</span><span class="nf">to_csv</span><span class="p">(</span><span class="s">'submission.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#dacon" class="page__taxonomy-item p-category" rel="tag">Dacon</a><span class="sep">, </span>
    
      <a href="/tags/#ml" class="page__taxonomy-item p-category" rel="tag">ml</a><span class="sep">, </span>
    
      <a href="/tags/#python" class="page__taxonomy-item p-category" rel="tag">python</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#dacon" class="page__taxonomy-item p-category" rel="tag">Dacon</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time class="dt-published" datetime="2023-02-02T00:00:00+09:00">February 2, 2023</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=%5BDacon%5D+%EC%97%AC%ED%96%89%EC%83%81%ED%92%88+%EC%8B%A0%EC%B2%AD%EC%98%88%EC%B8%A1%20http%3A%2F%2Flocalhost%3A4000%2Fdacon%2Fprediction-of-trevel-product%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fdacon%2Fprediction-of-trevel-product%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fdacon%2Fprediction-of-trevel-product%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/programmers/programmers-%EC%9D%B4%EB%AA%A8%ED%8B%B0%EC%BD%98%ED%95%A0%EC%9D%B8%ED%96%89%EC%82%AC/" class="pagination--pager" title="[Programmers] 이모티콘 할인행사
">이전</a>
    
    
      <a href="/programmers/programmers-network-solution/" class="pagination--pager" title="[Programmers] 네트워크
">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">참고</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/programmers/test/" rel="permalink">[Programmers] 네트워크
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-02-20T00:00:00+09:00">February 20, 2023</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          1 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">프로그래머스 네트워크
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/programmers/test2/" rel="permalink">[Programmers] 이모티콘 할인행사
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-02-19T00:00:00+09:00">February 19, 2023</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          1 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">프로그래머스 이모티콘 할인행사
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/programmers/programmers-network-solution/" rel="permalink">[Programmers] 네트워크
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-02-19T00:00:00+09:00">February 19, 2023</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          1 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">프로그래머스 네트워크 문제풀이
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/programmers/programmers-%EC%9D%B4%EB%AA%A8%ED%8B%B0%EC%BD%98%ED%95%A0%EC%9D%B8%ED%96%89%EC%82%AC/" rel="permalink">[Programmers] 이모티콘 할인행사
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-01-30T00:00:00+09:00">January 30, 2023</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          3 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">프로그래머스 이모티콘 할인행사
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Tae Hyeon Kim. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
