---
title:  "[Dacon] 유전체 정보 분류 경진대회"
categories: Dacon
tag: [python, Dacon, ml]
toc: true
author_profile: false
---

<head>
  <style>
    table.dataframe {
      white-space: normal;
      width: 100%;
      height: 240px;
      display: block;
      overflow: auto;
      font-family: Arial, sans-serif;
      font-size: 0.9rem;
      line-height: 20px;
      text-align: center;
      border: 0px !important;
    }

    table.dataframe th {
      text-align: center;
      font-weight: bold;
      padding: 8px;
    }

    table.dataframe td {
      text-align: center;
      padding: 8px;
    }

    table.dataframe tr:hover {
      background: #b8d1f3; 
    }

    .output_prompt {
      overflow: auto;
      font-size: 0.9rem;
      line-height: 1.45;
      border-radius: 0.3rem;
      -webkit-overflow-scrolling: touch;
      padding: 0.8rem;
      margin-top: 0;
      margin-bottom: 15px;
      font: 1rem Consolas, "Liberation Mono", Menlo, Courier, monospace;
      color: $code-text-color;
      border: solid 1px $border-color;
      border-radius: 0.3rem;
      word-break: normal;
      white-space: pre;
    }

  .dataframe tbody tr th:only-of-type {
      vertical-align: middle;
  }

  .dataframe tbody tr th {
      vertical-align: top;
  }

  .dataframe thead th {
      text-align: center !important;
      padding: 8px;
  }

  .page__content p {
      margin: 0 0 0px !important;
  }

  .page__content p > strong {
    font-size: 0.8rem !important;
  }

  </style>
</head>


# Import



```python
import pandas as pd
import random
import os
import numpy as np
import matplotlib.pyplot as plt

from sklearn import preprocessing
from sklearn.ensemble import RandomForestClassifier
```


```python
class CFG:
    SEED = 42
```


```python
def seed_everything(seed):
    random.seed(seed)
    os.environ['PYTHONHASHSEED'] = str(seed)
    np.random.seed(seed)
seed_everything(CFG.SEED) # Seed 고정
```

# Data Load



```python
from google.colab import drive
drive.mount('/content/drive')
```

<pre>
Mounted at /content/drive
</pre>

```python
train = pd.read_csv('/content/drive/MyDrive/data/유전체 정보 품종 분류/train.csv')
test = pd.read_csv('/content/drive/MyDrive/data/유전체 정보 품종 분류/test.csv')
```


<!-- ```python
train.head()
```


  <div id="df-5d3a637e-aa75-4b69-a0d4-4757fefe50b5">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>father</th>
      <th>mother</th>
      <th>gender</th>
      <th>trait</th>
      <th>SNP_01</th>
      <th>SNP_02</th>
      <th>SNP_03</th>
      <th>SNP_04</th>
      <th>SNP_05</th>
      <th>...</th>
      <th>SNP_07</th>
      <th>SNP_08</th>
      <th>SNP_09</th>
      <th>SNP_10</th>
      <th>SNP_11</th>
      <th>SNP_12</th>
      <th>SNP_13</th>
      <th>SNP_14</th>
      <th>SNP_15</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>TRAIN_000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>G G</td>
      <td>A G</td>
      <td>A A</td>
      <td>G A</td>
      <td>C A</td>
      <td>...</td>
      <td>A A</td>
      <td>G G</td>
      <td>A A</td>
      <td>G G</td>
      <td>A G</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TRAIN_001</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>A G</td>
      <td>A G</td>
      <td>C A</td>
      <td>A A</td>
      <td>A A</td>
      <td>...</td>
      <td>A A</td>
      <td>G A</td>
      <td>A A</td>
      <td>A G</td>
      <td>A A</td>
      <td>G A</td>
      <td>G G</td>
      <td>A A</td>
      <td>A A</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TRAIN_002</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>G G</td>
      <td>G G</td>
      <td>A A</td>
      <td>G A</td>
      <td>C C</td>
      <td>...</td>
      <td>A A</td>
      <td>G A</td>
      <td>G A</td>
      <td>A G</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
      <td>B</td>
    </tr>
    <tr>
      <th>3</th>
      <td>TRAIN_003</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>A A</td>
      <td>G G</td>
      <td>A A</td>
      <td>G A</td>
      <td>A A</td>
      <td>...</td>
      <td>G G</td>
      <td>A A</td>
      <td>G G</td>
      <td>A G</td>
      <td>G G</td>
      <td>G G</td>
      <td>G G</td>
      <td>A A</td>
      <td>G G</td>
      <td>A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TRAIN_004</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>G G</td>
      <td>G G</td>
      <td>C C</td>
      <td>A A</td>
      <td>C C</td>
      <td>...</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
      <td>G G</td>
      <td>A A</td>
      <td>A A</td>
      <td>A G</td>
      <td>A A</td>
      <td>G A</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5d3a637e-aa75-4b69-a0d4-4757fefe50b5')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none">
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z">
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5d3a637e-aa75-4b69-a0d4-4757fefe50b5 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5d3a637e-aa75-4b69-a0d4-4757fefe50b5');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div> -->
  



```python
def get_x_y(df):
    if 'class' in df.columns:
        df_x = df.drop(columns=['id', 'class'])
        df_y = df['class']
        return df_x, df_y
    else:
        df_x = df.drop(columns=['id'])
        return df_x
```


```python
train_x, train_y = get_x_y(train)
test_x = get_x_y(test)
train_x.head()
```


  <div id="df-207377ae-1092-48d6-87f6-7677548cc7fa">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>father</th>
      <th>mother</th>
      <th>gender</th>
      <th>trait</th>
      <th>SNP_01</th>
      <th>SNP_02</th>
      <th>SNP_03</th>
      <th>SNP_04</th>
      <th>SNP_05</th>
      <th>SNP_06</th>
      <th>SNP_07</th>
      <th>SNP_08</th>
      <th>SNP_09</th>
      <th>SNP_10</th>
      <th>SNP_11</th>
      <th>SNP_12</th>
      <th>SNP_13</th>
      <th>SNP_14</th>
      <th>SNP_15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>G G</td>
      <td>A G</td>
      <td>A A</td>
      <td>G A</td>
      <td>C A</td>
      <td>A A</td>
      <td>A A</td>
      <td>G G</td>
      <td>A A</td>
      <td>G G</td>
      <td>A G</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>A G</td>
      <td>A G</td>
      <td>C A</td>
      <td>A A</td>
      <td>A A</td>
      <td>A G</td>
      <td>A A</td>
      <td>G A</td>
      <td>A A</td>
      <td>A G</td>
      <td>A A</td>
      <td>G A</td>
      <td>G G</td>
      <td>A A</td>
      <td>A A</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>G G</td>
      <td>G G</td>
      <td>A A</td>
      <td>G A</td>
      <td>C C</td>
      <td>G G</td>
      <td>A A</td>
      <td>G A</td>
      <td>G A</td>
      <td>A G</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>A A</td>
      <td>G G</td>
      <td>A A</td>
      <td>G A</td>
      <td>A A</td>
      <td>G G</td>
      <td>G G</td>
      <td>A A</td>
      <td>G G</td>
      <td>A G</td>
      <td>G G</td>
      <td>G G</td>
      <td>G G</td>
      <td>A A</td>
      <td>G G</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>G G</td>
      <td>G G</td>
      <td>C C</td>
      <td>A A</td>
      <td>C C</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
      <td>A A</td>
      <td>G G</td>
      <td>A A</td>
      <td>A A</td>
      <td>A G</td>
      <td>A A</td>
      <td>G A</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-207377ae-1092-48d6-87f6-7677548cc7fa')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none">
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z">
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-207377ae-1092-48d6-87f6-7677548cc7fa button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-207377ae-1092-48d6-87f6-7677548cc7fa');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  


# Data Pre-processing

## Label-Encoding



```python
class_le = preprocessing.LabelEncoder()
snp_le = preprocessing.LabelEncoder()
snp_col = [f'SNP_{str(x).zfill(2)}' for x in range(1,16)]
```


```python
snp_col
```

<pre>
['SNP_01',
 'SNP_02',
 'SNP_03',
 'SNP_04',
 'SNP_05',
 'SNP_06',
 'SNP_07',
 'SNP_08',
 'SNP_09',
 'SNP_10',
 'SNP_11',
 'SNP_12',
 'SNP_13',
 'SNP_14',
 'SNP_15']
</pre>

```python
snp_data = []
for col in snp_col:
    snp_data += list(train_x[col].values)
```


```python
train_y = class_le.fit_transform(train_y)
snp_le.fit(snp_data)
```

<pre>
LabelEncoder()
</pre>

```python
for col in train_x.columns:
    if col in snp_col:
        train_x[col] = snp_le.transform(train_x[col])
        test_x[col] = snp_le.transform(test_x[col])
```


```python
train_x.head()
```


  <div id="df-d6c31fe2-0b92-47c3-999f-f308300ac5cf">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>father</th>
      <th>mother</th>
      <th>gender</th>
      <th>trait</th>
      <th>SNP_01</th>
      <th>SNP_02</th>
      <th>SNP_03</th>
      <th>SNP_04</th>
      <th>SNP_05</th>
      <th>SNP_06</th>
      <th>SNP_07</th>
      <th>SNP_08</th>
      <th>SNP_09</th>
      <th>SNP_10</th>
      <th>SNP_11</th>
      <th>SNP_12</th>
      <th>SNP_13</th>
      <th>SNP_14</th>
      <th>SNP_15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d6c31fe2-0b92-47c3-999f-f308300ac5cf')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none">
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z">
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d6c31fe2-0b92-47c3-999f-f308300ac5cf button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d6c31fe2-0b92-47c3-999f-f308300ac5cf');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  



```python
from sklearn.model_selection import train_test_split

x_train,x_valid,y_train,y_valid = train_test_split(train_x,train_y,test_size = 0.2,random_state=42)
x_train.head()
```


  <div id="df-75d52ff9-b370-4fb3-a783-a70c6c29b1b3">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>father</th>
      <th>mother</th>
      <th>gender</th>
      <th>trait</th>
      <th>SNP_01</th>
      <th>SNP_02</th>
      <th>SNP_03</th>
      <th>SNP_04</th>
      <th>SNP_05</th>
      <th>SNP_06</th>
      <th>SNP_07</th>
      <th>SNP_08</th>
      <th>SNP_09</th>
      <th>SNP_10</th>
      <th>SNP_11</th>
      <th>SNP_12</th>
      <th>SNP_13</th>
      <th>SNP_14</th>
      <th>SNP_15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>179</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>5</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>115</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>96</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
      <td>5</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>233</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>60</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-75d52ff9-b370-4fb3-a783-a70c6c29b1b3')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none">
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z">
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-75d52ff9-b370-4fb3-a783-a70c6c29b1b3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-75d52ff9-b370-4fb3-a783-a70c6c29b1b3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  



```python
print(train_x.shape)
print(x_train.shape)
```

<pre>
(262, 19)
(209, 19)
</pre>

```python
def data_preprocessing():
  train = pd.read_csv('/content/drive/MyDrive/data/유전체 정보 품종 분류/train.csv')
  test = pd.read_csv('/content/drive/MyDrive/data/유전체 정보 품종 분류/test.csv')

  train_x, train_y = get_x_y(train)
  test_x = get_x_y(test)
  
  class_le = preprocessing.LabelEncoder()
  snp_le = preprocessing.LabelEncoder()
  snp_col = [f'SNP_{str(x).zfill(2)}' for x in range(1,16)]

  snp_data = []
  for col in snp_col:
      snp_data += list(train_x[col].values)

  train_y = class_le.fit_transform(train_y)
  snp_le.fit(snp_data)

  for col in train_x.columns:
      if col in snp_col:
          train_x[col] = snp_le.transform(train_x[col])
          test_x[col] = snp_le.transform(test_x[col])

  x_train,x_valid,y_train,y_valid = train_test_split(train_x,train_y,test_size = 0.2,random_state=42)

  return x_train,x_valid,y_train,y_valid,test_x
```

# Data Engineering


## Feature Seletion


### Feature Importance



```python
model = RandomForestClassifier(random_state=CFG.SEED)
model.fit(x_train, y_train)
```

<pre>
RandomForestClassifier(random_state=42)
</pre>

```python
from sklearn.metrics import f1_score

y_pred = model.predict(x_valid)
#f1_score(y_pred,y_valid, average='macro')
```


```python
def make_plot():
  f1_sco = f1_score(y_pred,y_valid,average='macro')

  
  validation = pd.DataFrame({'y_valid':y_valid,'y_pred':y_pred})

  validation_count = pd.DataFrame(validation['y_valid'].value_counts().sort_index())
  validation_count.loc[validation['y_pred'].value_counts().sort_index().index,'y_pred']=validation['y_pred'].value_counts().sort_index().values
  validation_count = validation_count.fillna(0)

  x = validation_count.index
  y_valid_count = validation_count['y_valid']
  y_pred_count = validation_count['y_pred']

  width = 0.35

  plt.figure(dpi=100)

  plt.title('F1-score: '+str(f1_sco)[:6])
  plt.xlabel('quality')
  plt.ylabel('count')

  p1 = plt.bar([idx-width/2 for idx in x],y_valid_count,width,label = 'real')
  p2 = plt.bar([idx+width/2 for idx in x],y_pred_count,width,label = 'pred')

  plt.legend()
  plt.show()
```


```python
make_plot()
```

<img src="data:image/png;base64,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xo0bx9SpU5k6depK+wxHJiRJUiWGCUmSWtzixYubXUKPDBOSJA2wSZMmMWXKFKZMmcLo0aNZb731OPnkkzsf1DVu3DhOPfVUDj30UEaNGsVnP/tZAG677TZ22203hg8fztixYznmmGN47bXXOvc7e/Zs9ttvP4YPH87mm2/Oj370owH5fgwTkiQ1wWWXXcaQIUO46667+Na3vsXZZ5/NRRdd1Ln+rLPO4p3vfCf33XcfJ598Mk8++SSTJ0/mgAMO4IEHHuDHP/4xt912G1OmTOnc5rDDDuOZZ57hlltu4Wc/+xnf/e53mT179kr/XpyAKUlSE4wdO5ZzzjmHiGDChAk8+OCDnHPOOXzmM58BYM899+T444/v7H/EEUfwyU9+snMi5fjx4znvvPPYY489uOCCC3j66ae59tprueuuu9hxxx0BuPjii3n729++0r8XRyYkSWqCXXbZhYjofL/rrrvy+OOPs2TJEgB22GGHZfrff//9XHrppYwcObJz2XvvvVm6dCkzZszgkUceYciQIWy//fad22y11VaMGTNmpX8vjkxIktSCRowYscz7+fPnc+SRR3LMMccs13fTTTflscceG6jSlmOYkCSpCe68885l3v/+979n/PjxDB48uMv+2223HQ8//DBbbrlll+u32mor3nzzTe69997O0xyPPvoor7zySv8W3gVPc0iS1ARPP/00xx13HI8++iiXX3453/72tzn22GO77X/CCSfwu9/9jilTpjB9+nQef/xxfv7zn3dOwJwwYQKTJ0/myCOP5M477+Tee+/liCOOYPjw4Sv9e3FkQpK06mnhO1J2OPTQQ1m4cCE77bQTgwcP5thjj+28BLQrW2+9Nb/5zW846aST2G233chMtthiCz7+8Y939vnBD37AEUccwR577MEGG2zAaaedxsknn7zSvxfDhCRJTTB06FDOPfdcLrjgguXWzZw5s8ttdtxxR2644YZu97nhhhvyy1/+cpm2Qw45pFKdveFpDkmSVIlhQpIkVeJpDkmSBti0adOaXUK/cmRCkiRVYpiQJLW1jodjqTH9cfwME5KktjR06FAAFixY0ORK2lvH8es4no1wzoQkqS0NHjyYMWPGdD4Vc6211lrmWRfqWWayYMECZs+ezZgxY7q982ZvGCYkSW1rww03BBiQx2yvqsaMGdN5HBtlmJAkta2IYKONNuItb3kLb7zxRrPLaTtDhw6tNCLRwTAhSWp7gwcP7pc/imqMEzAlSVIlhglJklRJU8NERJwYEXdHxKsRMTsiro6ICXV91oyI70TEyxExPyKujIgNmlWzJElaVrNHJvYAvgPsAnwAGArcEBEjavqcA+wHfKzsvzFw1QDXKUmSutHUCZiZObn2fUQcBswGtgdujYjRwD8AB2fmzWWfw4FHImKXzPz9AJcsSZLqNHtkot7o8nVO+bo9xWjFjR0dMvOPwNPArl3tICLWiIhRHQuw9kqsV5Kk1V7LhImIGAScC9yemQ+VzRsCizPzlbruL5TrunIiMLdmeXYllCtJkkotEyYo5k5MBD5RcT+nU4xwdCybVNyfJEnqQUvctCoizgf2BXbPzNqRhOeBYRExpm50YoNy3XIycxGwqGbfK6FiSZLUodmXhkYZJPYH9szMGXVd7gXeAN5Xs80EYFPgjgErVJIkdavZIxPfAQ4GPgy8GhEd8yDmZubCzJwbERcDZ0fEHGAe8G3gDq/kkCSpNTQ7TBxVvk6raz8cuLT8+vPAUuBKYA3geuAfB6A2SZLUC82+z8QKJzRk5uvA0eUiSZJaTCtdzSFJktqQYUKSJFVimJAkSZUYJiRJUiWGCUmSVIlhQpIkVWKYkCRJlRgmJElSJYYJSZJUiWFCkiRVYpiQJEmVGCYkSVIlhglJklSJYUKSJFVimJAkSZUYJiRJUiWGCUmSVIlhQpIkVWKYkCRJlRgmJElSJYYJSZJUiWFCkiRVYpiQJEmVGCYkSVIlhglJklSJYUKSJFVimJAkSZUYJiRJUiWGCUmSVIlhQpIkVWKYkCRJlRgmJElSJYYJSZJUiWFCkiRVYpiQJEmVGCYkSVIlhglJklSJYUKSJFVimJAkSZUYJiRJUiWGCUmSVMmQZhcgSWo94/7lV80uYaWZ+Y19ml3CKseRCUmSVIlhQpIkVWKYkCRJlRgmJElSJYYJSZJUiWFCkiRVYpiQJEmVNDVMRMTuEXFNRDwXERkRH6lbf2nZXrtc16x6JUnS8po9MjECuB84uoc+1wEb1SwHDUBdkiSpl5p6B8zMvBa4FiAiuuu2KDOfH7CiJElSnzR7ZKI3JkXE7Ih4NCIuiIh1e+ocEWtExKiOBVh7gOqUJGm11OrP5rgOuAqYAWwBfB24NiJ2zcwl3WxzIvCVAapPktRuThnd7ApWnlPmNuVjWzpMZOYVNW8fjIgHgCeBScBN3Wx2OnB2zfu1gWdXSoGSJKktTnN0ysw/AS8BW/bQZ1FmzutYgFcHrEBJklZDbRUmImITYF1gVrNrkSRJhaae5oiIkSw7yrB5RGwDzCmXrwBXAs9TzJk4E3gCuH6AS5UkSd1o9pyJHYBbat53zHW4DDgK2Br4FDAGeA64ATg5MxcNZJGSJKl7zb7PxDSg2xtMAHsPUCmSJKlBbTVnQpIktR7DhCRJqsQwIUmSKjFMSJKkSgwTkiSpkoau5oiIm4GPZuYrde2jgKszc8/+KK6VjfuXXzW7hJVm5poHN7uEladJ962XpFVZoyMTk4BhXbSvCezWcDWSJKnt9GlkIiK2rnn7jojYsOb9YGAy8Of+KEySJLWHvp7mmA5kudzcxfqFwD9VLUqSJLWPvoaJzSnuWPknYCfgxZp1i4HZmbmkn2qTJEltoE9hIjOfKr/0KhBJkgRUeDZHRIwH3gu8hbpwkZn/VrEuSZLUJhq9NPQzwAXASxSPB8+a1QkYJiRJWk00OjLxJeCkzDyjP4uRJEntp9G5D+sAP+3PQiRJUntqNEz8FNirPwuRJEntqdHTHE8Ap0bELsCDwBu1KzPzvKqFSZKk9tBomPgsMB/Yo1xqJWCYkCRpNdFQmMjMzfu7EEmS1J68+ZQkSaqk0ftMXNLT+sz8dGPlSJKkdtPonIl16t4PBSYCY+j6AWCSJGkV1eicif3r2yJiEMVdMZ+sWpQkSWof/TZnIjOXAmcDn++vfUqSpNbX3xMwt6DCw8MkSVL7aXQC5tn1TcBGwD7AZVWLkiRJ7aPRUYRt694vBV4Ejgd6vNJDkiStWhqdgPne/i5EkiS1p0rzGyJifWBC+fbRzHyxekmSJKmdNDQBMyJGlDeumgXcWi7PRcTFEbFWfxYoSZJaW6NXc5xN8YCv/ShuVDUG+HDZ9u/9U5okSWoHjZ7mOAD4u8ycVtP264hYCPwEOKpqYZIkqT00OjKxFvBCF+2zy3WSJGk10WiYuAP4akSs2dEQEcOBr5TrJEnSaqLR0xxTgeuAZyPi/rLtncAiYK/+KEySJLWHRu8z8WBEjAc+CWxVNl8O/CgzF/ZXcZIkqfU1ejvtE4EXMvPCuvZPR8T6mXlGv1QnSZJaXqNzJo4E/thF+x+AzzVejiRJajeNhokNKW5YVe9Figd+SZKk1USjYeIZ4N1dtL8beK7xciRJUrtp9GqOC4FzI2IocHPZ9j7gTLwDpiRJq5VGw8Q3gXWB7wLDyrbXgTMy8/T+KEySJLWHRi8NTeCEiDgVeDuwEHg8Mxf1Z3GSJKn1VXoEeWbOB+7up1okSVIbanQCpiRJEmCYkCRJFRkmJElSJYYJSZJUiWFCkiRV0tQwERG7R8Q1EfFcRGREfKRufUTEv0XErIhYGBE3lk8rlSRJLaLZIxMjgPuBo7tZ/0XgGIqHh+0MvAZcHxFrDkx5kiRpRSrdZ6KqzLwWuBYgIpZZF0XDVOC0zPx52XYo8ALwEeCKAS1WkiR1qdkjEz3ZnOLppDd2NGTmXOBOYNfuNoqINSJiVMcCrL3SK5UkaTXWymFiw/L1hbr2F2rWdeVEYG7N8mz/lyZJkjq0cpho1OnA6Jplk+aWI0nSqq2pcyZW4PnydQNgVk37BsD07jYqHzbW+cCx+rkYkiSpf7XyyMQMikDxvo6Gcg7EzsAdzSpKkiQtq6kjExExEtiypmnziNgGmJOZT0fEucCXIuJxinBxKvAccPXAVytJkrrS7NMcOwC31Lw/u3y9DDgMOJPiXhTfB8YAtwGTM/P1AaxRkiT1oNn3mZgGdDupITMT+HK5SJKkFtTKcyYkSVIbMExIkqRKDBOSJKkSw4QkSarEMCFJkioxTEiSpEoME5IkqRLDhCRJqsQwIUmSKjFMSJKkSgwTkiSpEsOEJEmqxDAhSZIqMUxIkqRKDBOSJKkSw4QkSarEMCFJkioxTEiSpEoME5IkqRLDhCRJqsQwIUmSKjFMSJKkSgwTkiSpEsOEJEmqxDAhSZIqMUxIkqRKDBOSJKkSw4QkSarEMCFJkioxTEiSpEoME5IkqRLDhCRJqsQwIUmSKjFMSJKkSgwTkiSpEsOEJEmqxDAhSZIqMUxIkqRKDBOSJKkSw4QkSarEMCFJkioxTEiSpEoME5IkqRLDhCRJqsQwIUmSKjFMSJKkSgwTkiSpEsOEJEmqxDAhSZIqaekwERGnRETWLX9sdl2SJOl/DWl2Ab3wB+D9Ne/fbFYhkiRpee0QJt7MzOebXYQkSepaS5/mKI2PiOci4k8R8aOI2LSnzhGxRkSM6liAtQeoTkmSVkutHibuBA4DJgNHAZsDv42IngLCicDcmuXZlVyjJEmrtZYOE5l5bWb+NDMfyMzrgQ8BY4ADe9jsdGB0zbLJyq9UkqTVVzvMmeiUma9ExGPAlj30WQQs6ngfEQNRmiRJq62WHpmoFxEjgS2AWc2uRZIkFVo6TETEWRGxR0SMi4h3Af8FLAEub3JpkiSp1OqnOTahCA7rAi8CtwG7ZOaLTa1KkiR1aukwkZmfaHYNkiSpZy19mkOSJLU+w4QkSarEMCFJkioxTEiSpEoME5IkqRLDhCRJqsQwIUmSKjFMSJKkSgwTkiSpEsOEJEmqxDAhSZIqMUxIkqRKDBOSJKkSw4QkSarEMCFJkioxTEiSpEoME5IkqRLDhCRJqsQwIUmSKjFMSJKkSgwTkiSpEsOEJEmqxDAhSZIqMUxIkqRKDBOSJKkSw4QkSarEMCFJkioxTEiSpEoME5IkqRLDhCRJqsQwIUmSKjFMSJKkSgwTkiSpEsOEJEmqxDAhSZIqMUxIkqRKDBOSJKkSw4QkSarEMCFJkioxTEiSpEoME5IkqRLDhCRJqsQwIUmSKjFMSJKkSgwTkiSpEsOEJEmqxDAhSZIqMUxIkqRKDBOSJKmStggTEXF0RMyMiNcj4s6I2KnZNUmSpELLh4mI+DhwNvBVYDvgfuD6iHhLUwuTJElAG4QJ4Djgwsz8QWY+DHwOWAB8urllSZIkgCHNLqAnETEM2B44vaMtM5dGxI3Art1sswawRk3T2gDz5s3r19qWLlrQr/trJfMim13CytPPPwcDaVX9mfPnrTWtqj9v4M9c33bXu/1FZuse1IjYGPgz8K7MvKOm/Uxgj8zcuYttTgG+MmBFSpK06tskM//c3cqWHplo0OkUcyxq/RUwpwm1tKO1gWeBTYBXm1xLO/G4Ncbj1jiPXWM8bn23NvBcTx1aPUy8BCwBNqhr3wB4vqsNMnMRsKiuuX3HGgdYRHR8+Wpmetx6yePWGI9b4zx2jfG4NWSFx6mlJ2Bm5mLgXuB9HW0RMah8f0d320mSpIHT6iMTUJyyuCwi7gHuAqYCI4AfNLUqSZIEtEGYyMwfR8T6wL8BGwLTgcmZ+UJzK1tlLaK4p0f9qSL1zOPWGI9b4zx2jfG4rQQtfTWHJElqfS09Z0KSJLU+w4QkSarEMCFJkioxTEiSpEoME6uhvj7SPSI+FhF/LPs/GBEfGqhaW0lfjltEHBYRWbe8PpD1toKI2D0iromI58pj8JFebDMpIv4nIhZFxBMRcdgAlNpS+nrcymNW//OWEbHhQNXcCiLixIi4OyJejYjZEXF1REzoxXb+jqvIMLGa6esj3SPiXcDlwMXAtsDVwNURMXFgKm4NfT1upXnARjXLZiu7zhY0guJYHd2bzhGxOfAr4BZgG+Bc4KKI2HulVdia+nTcakxg2Z+52f1cV6vbA/gOsAvwAWAocENEjOhuA3/H9Q8vDV3NRMSdwN2ZOaV8Pwh4Bvh2Zn6ji/4/BkZk5r41bb8Hpmfm5wao7KZr4LgdBpybmWMGtNAWFhEJ7J+ZV/fQ5wxgn8ycWNN2BTAmMycPQJktp5fHbR9rD70AAAVySURBVBJFAFsnM18ZqNpaXXmPotkUD4a8tZs+/o7rB45MrEZqHul+Y0dbZi4t33f5SPey/ca6tut76L/KafC4AYyMiKci4pmI+HlE/M1KLnVVsNr/vFU0PSJmRcR/R8S7m11MCxhdvvb0oEd/5vqBYWL1sh4wGKi/e+gLFHcX7cqGfey/KmrkuD0KfBr4MPD3FP+v/S4iNllZRa4iuvt5GxURw5tQT7uYBXwOOKBcngGmRcR2Ta2qicrRw3OB2zPzoR66+juuH7T87bSldpSZd1DzMLqI+B3wCHAkcHKz6tKqKTMfpQiwHX4XEVsAnwcOaU5VTfcdYCLwnmYXsjpwZGL10udHupftfem/KmrkuC0jM98A7gO27N/SVjnd/bzNy8yFTainnd3FavrzFhHnA/sC783MZ1fQ3d9x/cAwsRpp8JHud9T2L32gh/6rnAaP2zIiYjDwtxTD0ereav/z1o+2YTX7eYvC+cD+wJ6ZOaMXm/kz1w88zbH66fGR7hHxQ+DPmXli2f9bwG8i4niKS/Y+AewAfHagC2+yPh23iPgy8HvgCWAM8AWKS0MvGvjSmyciRrLsv443j4htgDmZ+XREnA78dWYeWq7/HjAlIs4ELgH2BA4E9hnIuputr8ctIqYCM4A/AGsCR1Acu70GtvKm+w5wMMVcpVdr7rMxt2Nky99xK0lmuqxmCzAFeIriEbx3AjvXrJsGXFrX/2MU52MXAQ8BH2r299Dqxw04p6bv8xS/pLZt9vfQhGM2CcgulkvL9ZcC07rY5r7y2D0JHNbs76PVjxvwRYrguhB4meIy0fc2+/townHr6phl7c+Qv+NWzuJ9JiRJUiXOmZAkSZUYJiRJUiWGCUmSVIlhQpIkVWKYkCRJlRgmJElSJYYJSZJUiWFCkiRVYpiQ1DIi4pSImF7z/tKIuLqZNUlaMZ/NIamVHQtEx5uImAZMz8ypTatI0nIME5JaVmbObXYNklbM0xySeiUiRkTEDyNifkTMiojjI2JaRJxbrs+I+EjdNq9ExGE178+IiMciYkFE/CkiTo2IoT18Zudpjoi4FNgDOLb8rIyIzSPiiYj457rttinXb9nFbiX1M8OEpN76JsUf8w9TPNp6ErBdH/fxKnAY8A6KUxifAT7fy22PBe4ALgQ2KpenKR5Vfnhd38OBWzPziT7WJ6kBhglJKxQRI4F/AP45M2/KzAeBT9HHU6WZeVpm/i4zZ2bmNcBZwIG93HYusBhYkJnPl8sSisdxT4iIncpahwIHU4QMSQPAOROSemMLYBhwZ0dDZs6JiEf7spOI+DhwTLm/kRS/g+ZVKSwzn4uIXwGfBu4C9gPWAH5aZb+Ses+RCUn9Jam58qLUOR8iInYFfgT8GtgX2Bb4GkVIqeoi4BMRMZziFMePM3NBP+xXUi84MiGpN54E3gB2ppinQESsA7wN+E3Z50WKeQyU68cDa9Xs413AU5n5tZo+m/WxjsXA4C7afw28BhwFTAZ27+N+JVVgmJC0Qpk5PyIuBr4ZES8DsylGFZbWdLsZmBIRd1D8wT+DIoB0eBzYNCI+AdwN7APs38dSZgI7R8Q4YD4wJzOXZuaS8mqP04HHM/OOPu5XUgWe5pDUW18AfgtcA9wI3AbcW7P+eOCZss9/Ukyu7DzVkJm/AM4BzgemU4xUnNrHGs4ClgAPU4yEbFqz7mKKUyY/6OM+JVUUmdnsGiS1qVa6I2VE7AbcBIzNzBeaXY+0OvE0h6S2FhFrAOsDpwA/NUhIA8/THJLa3UHAU8AY4ItNrkVaLXmaQ5IkVeLIhCRJqsQwIUmSKjFMSJKkSgwTkiSpEsOEJEmqxDAhSZIqMUxIkqRKDBOSJKmS/w82a0RMlR4dkAAAAABJRU5ErkJggg==">

클래스 1과 2에서 혼동하는 모습



```python
feature_imp = pd.DataFrame(model.feature_importances_,index = train_x.columns,columns = ['importance'])
feature_imp.sort_values(by='importance',ascending=False)
```


  <div id="df-b70e99b2-965b-4b7a-a50d-6bebff4ed9b4">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>importance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>trait</th>
      <td>0.149997</td>
    </tr>
    <tr>
      <th>SNP_05</th>
      <td>0.110934</td>
    </tr>
    <tr>
      <th>SNP_10</th>
      <td>0.098379</td>
    </tr>
    <tr>
      <th>SNP_07</th>
      <td>0.087005</td>
    </tr>
    <tr>
      <th>SNP_08</th>
      <td>0.083492</td>
    </tr>
    <tr>
      <th>SNP_04</th>
      <td>0.071618</td>
    </tr>
    <tr>
      <th>SNP_12</th>
      <td>0.056224</td>
    </tr>
    <tr>
      <th>SNP_14</th>
      <td>0.047945</td>
    </tr>
    <tr>
      <th>SNP_03</th>
      <td>0.047389</td>
    </tr>
    <tr>
      <th>SNP_02</th>
      <td>0.046950</td>
    </tr>
    <tr>
      <th>SNP_01</th>
      <td>0.046350</td>
    </tr>
    <tr>
      <th>SNP_15</th>
      <td>0.038371</td>
    </tr>
    <tr>
      <th>SNP_11</th>
      <td>0.035263</td>
    </tr>
    <tr>
      <th>SNP_13</th>
      <td>0.034316</td>
    </tr>
    <tr>
      <th>SNP_09</th>
      <td>0.028967</td>
    </tr>
    <tr>
      <th>SNP_06</th>
      <td>0.016798</td>
    </tr>
    <tr>
      <th>mother</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>gender</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>father</th>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b70e99b2-965b-4b7a-a50d-6bebff4ed9b4')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none">
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z">
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b70e99b2-965b-4b7a-a50d-6bebff4ed9b4 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b70e99b2-965b-4b7a-a50d-6bebff4ed9b4');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  


상관계수가 낮은 feature들이 많은 것을 알 수 있다. 





그러한 feature 들을 제외하고 학습한 뒤 성능을 확인해보자



```python
# 상관계수가 높은 상위 5개 feature
feature_5 = feature_imp.sort_values(by='importance',ascending=False).index[:5]
feature_5
```

<pre>
Index(['trait', 'SNP_05', 'SNP_10', 'SNP_07', 'SNP_08'], dtype='object')
</pre>

```python
x_train,x_valid,y_train,y_valid,test_x = data_preprocessing()

x_train = x_train[feature_5]
x_valid = x_valid[feature_5]

# 정확한 비교를 위해 똑같은 랜덤포레스트 모델 사용
model = RandomForestClassifier(random_state=CFG.SEED)
model.fit(x_train, y_train)
y_pred = model.predict(x_valid)
make_plot()
```

<img src="data:image/png;base64,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7ih/btm/VUmS1H8uvvhihg4dyp133sm3v/1tzjrrLH784x+vWH/mmWfyjne8gz/+8Y+cdNJJzJo1iylTpnDggQdy33338bOf/YxbbrmFadOmrdhm6tSpPPnkk9x000388pe/5Pvf/z5z587t99fS1NMcERHAd4EDgMmZObsHm21T/pzTb4VJktTPxo0bx9lnn01EMHHiRO6//37OPvtsPvvZzwKw5557ctxxx63of/jhh3PIIYesmEg5YcIEvvOd77DHHnvwgx/8gCeeeIJrr72WO++8kx133BGA888/n7e97W39/lqaPWfiXOBg4IPASxGxYdk+PzMXl6cyDgZ+BbxAMWfibODmzLyvGQVLktQXdtllF4q/qQu77ror3/rWt1i2bBkAO+yww0r97733Xu67776VTl1kJsuXL2f27Nk8/PDDDB06lO23337F+q222oqxY8f28ytpfpg4svw5o679MOAiYCmwFzAdGAU8CVwOnDow5UmS1ByjRq18y6WFCxdyxBFHcPTRR7+u76abbsrDDz88UKW9TrPvMxGrWP8kxY2tJElardxxxx0rPf7973/PhAkTGDJkSKf9t9tuOx588EG23LLzKYNbbbUVr732Gvfcc8+K0xwPPfQQL774Yt8W3omWmIApSdJg88QTT3Dsscfy0EMPcemll/Ld736XY445psv+J5xwArfddhvTpk1j5syZPPLII1x11VUrJmBOnDiRKVOmcMQRR3DHHXdwzz33cPjhhzNixIh+fy3NPs0hSVLfa+E7UnY49NBDWbx4MTvttBNDhgzhmGOOWXEJaGe23nprfvvb3/LlL3+Z3Xffncxkiy224OMf//iKPhdeeCGHH344e+yxBxtssAGnnnoqJ510Ur+/lui4pnV1FRGjgfnz589n9OjRzS5HUr2Bvu3xQGqDD7R29sorrzB79mw233xz1lprrWaX0yuTJ09mm2224Zxzzml2Kd0exwULFjBmzBiAMeW9mzrlaQ5JklSJYUKSJFXinAlJkgbYjBkzml1Cn3JkQpIkVWKYkCS1tdX9QoL+1hfHzzAhSWpLw4YNA2DRokVNrqS9dRy/juPZCOdMSJLa0pAhQxg7duyKb8UcOXLkSt91oe5lJosWLWLu3LmMHTu2yztv9oRhQpLUtjbcsPh+yIH4mu3V1dixY1ccx0YZJiRJbSsi2GijjXjT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">

학습에 포함시킬 feature 개수를 찾아보자



```python
score_list = []
for i in range(len(feature_imp)-1,0,-1):
  feature_tmp = feature_imp.sort_values(by='importance',ascending=False).index[:i]
  x_train,x_valid,y_train,y_valid,test_x = data_preprocessing()

  x_train = x_train[feature_tmp]
  x_valid = x_valid[feature_tmp]

  # 정확한 비교를 위해 똑같은 랜덤포레스트 모델 사용
  model = RandomForestClassifier(random_state=CFG.SEED)
  model.fit(x_train, y_train)

  y_pred = model.predict(x_valid)
  score_list.append((i+1,f1_score(y_pred,y_valid, average='macro')))
score_list
```

<pre>
[(19, 0.9821551132463967),
 (18, 0.9821551132463967),
 (17, 1.0),
 (16, 0.9638888888888889),
 (15, 0.9451090781140042),
 (14, 0.9821551132463967),
 (13, 0.9638888888888889),
 (12, 0.9638888888888889),
 (11, 0.9638888888888889),
 (10, 0.9451090781140042),
 (9, 0.9464653397391901),
 (8, 0.9464653397391901),
 (7, 0.9464653397391901),
 (6, 0.9257142857142857),
 (5, 0.9646739130434782),
 (4, 0.9277777777777777),
 (3, 0.7947368421052632),
 (2, 0.5806451612903226)]
</pre>
상위 17개의 feature을 사용하는 것이 가장 성능이 좋은 것으로 보임



```python
feature_tmp = feature_imp.sort_values(by='importance',ascending=False).index[:16]
x_train,x_valid,y_train,y_valid,test_x = data_preprocessing()

x_train = x_train[feature_tmp]
x_valid = x_valid[feature_tmp]


model = RandomForestClassifier(random_state=CFG.SEED)
model.fit(x_train, y_train)

y_pred = model.predict(x_valid)
f1_score(y_pred,y_valid, average='macro')
```

<pre>
1.0
</pre>
validation 셋에 대한 성능이 좋게 나왔으므로 전체데이터에 대한 학습을 통해 제출



```python
# 제출 함수
def submit(file_name,pred):
  submit = pd.read_csv('/content/drive/MyDrive/data/유전체 정보 품종 분류/sample_submission.csv')
  submit['class'] = class_le.inverse_transform(pred)
  submit.to_csv(f'/content/drive/MyDrive/Colab Notebooks/dacon/{file_name}.csv', index=False)
  print('Done')
```


```python
model = RandomForestClassifier(random_state=CFG.SEED)
model.fit(train_x[feature_tmp], train_y)

pred = model.predict(test_x[feature_tmp])
submit('rf_17_feature',pred)
```

<pre>
Done
</pre>
결과를 확인해보았으나 베이스라인코드의 제출결과와 같은 결과가 나옴


릿지 모델에도 적용



```python
from sklearn.linear_model import RidgeClassifier

x_train,x_valid,y_train,y_valid,test_x = data_preprocessing()

model = RidgeClassifier(random_state=CFG.SEED)
model.fit(x_train, y_train)

pd.DataFrame(abs(model.coef_))
```


  <div id="df-5f229c12-5859-4d8f-8b7a-2679f19cb718">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.515546</td>
      <td>0.008958</td>
      <td>0.010171</td>
      <td>0.011026</td>
      <td>0.011176</td>
      <td>0.006956</td>
      <td>0.002418</td>
      <td>0.023188</td>
      <td>0.007393</td>
      <td>0.013038</td>
      <td>0.007025</td>
      <td>0.013207</td>
      <td>0.012130</td>
      <td>0.006696</td>
      <td>0.019875</td>
      <td>0.005807</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.352045</td>
      <td>0.040708</td>
      <td>0.055363</td>
      <td>0.086292</td>
      <td>0.110782</td>
      <td>0.237609</td>
      <td>0.005510</td>
      <td>0.124689</td>
      <td>0.114634</td>
      <td>0.083659</td>
      <td>0.115097</td>
      <td>0.043387</td>
      <td>0.019054</td>
      <td>0.052472</td>
      <td>0.110547</td>
      <td>0.042401</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.867591</td>
      <td>0.031750</td>
      <td>0.065533</td>
      <td>0.075266</td>
      <td>0.121959</td>
      <td>0.230653</td>
      <td>0.003092</td>
      <td>0.101501</td>
      <td>0.107241</td>
      <td>0.096697</td>
      <td>0.108072</td>
      <td>0.056594</td>
      <td>0.006924</td>
      <td>0.045776</td>
      <td>0.090672</td>
      <td>0.036594</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5f229c12-5859-4d8f-8b7a-2679f19cb718')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none">
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z">
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5f229c12-5859-4d8f-8b7a-2679f19cb718 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5f229c12-5859-4d8f-8b7a-2679f19cb718');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  



```python
average_feature_effects = abs(model.coef_ )* np.asarray(x_train.mean(axis=0)).ravel()
feature_list = []
for i in range(3):
  # 각 클래스 별 상관관계가 높은 feature 상위 5개씩 학습할 feature에 추가
  tmp = np.argsort(average_feature_effects[i])[-10:][::-1]
  for j in tmp:
    feature_list.append(j)
feature_list = list(set(feature_list))

x_train,x_valid,y_train,y_valid,test_x = data_preprocessing()

x_train = x_train[x_train.columns[feature_list]]
x_valid = x_valid[x_valid.columns[feature_list]]

model = RidgeClassifier(random_state=CFG.SEED)
model.fit(x_train, y_train)

y_pred = model.predict(x_valid)
f1_score(y_pred,y_valid, average='macro')
```

<pre>
0.9821551132463967
</pre>

```python
make_plot()
```

<img src="data:image/png;base64,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xo0bx9SpU5k6depK+wxHJiRJUiWGCUmSWtzixYubXUKPDBOSJA2wSZMmMWXKFKZMmcLo0aNZb731OPnkkzsf1DVu3DhOPfVUDj30UEaNGsVnP/tZAG677TZ22203hg8fztixYznmmGN47bXXOvc7e/Zs9ttvP4YPH87mm2/Oj370owH5fgwTkiQ1wWWXXcaQIUO46667+Na3vsXZZ5/NRRdd1Ln+rLPO4p3vfCf33XcfJ598Mk8++SSTJ0/mgAMO4IEHHuDHP/4xt912G1OmTOnc5rDDDuOZZ57hlltu4Wc/+xnf/e53mT179kr/XpyAKUlSE4wdO5ZzzjmHiGDChAk8+OCDnHPOOXzmM58BYM899+T444/v7H/EEUfwyU9+snMi5fjx4znvvPPYY489uOCCC3j66ae59tprueuuu9hxxx0BuPjii3n729++0r8XRyYkSWqCXXbZhYjofL/rrrvy+OOPs2TJEgB22GGHZfrff//9XHrppYwcObJz2XvvvVm6dCkzZszgkUceYciQIWy//fad22y11VaMGTNmpX8vjkxIktSCRowYscz7+fPnc+SRR3LMMccs13fTTTflscceG6jSlmOYkCSpCe68885l3v/+979n/PjxDB48uMv+2223HQ8//DBbbrlll+u32mor3nzzTe69997O0xyPPvoor7zySv8W3gVPc0iS1ARPP/00xx13HI8++iiXX3453/72tzn22GO77X/CCSfwu9/9jilTpjB9+nQef/xxfv7zn3dOwJwwYQKTJ0/myCOP5M477+Tee+/liCOOYPjw4Sv9e3FkQpK06mnhO1J2OPTQQ1m4cCE77bQTgwcP5thjj+28BLQrW2+9Nb/5zW846aST2G233chMtthiCz7+8Y939vnBD37AEUccwR577MEGG2zAaaedxsknn7zSvxfDhCRJTTB06FDOPfdcLrjgguXWzZw5s8ttdtxxR2644YZu97nhhhvyy1/+cpm2Qw45pFKdveFpDkmSVIlhQpIkVeJpDkmSBti0adOaXUK/cmRCkiRVYpiQJLW1jodjqTH9cfwME5KktjR06FAAFixY0ORK2lvH8es4no1wzoQkqS0NHjyYMWPGdD4Vc6211lrmWRfqWWayYMECZs+ezZgxY7q982ZvGCYkSW1rww03BBiQx2yvqsaMGdN5HBtlmJAkta2IYKON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">

validation 셋에 대한 성능은 잘 나오지 않지만 제출결과 확인을 위해 제출



```python
model = RidgeClassifier(random_state=CFG.SEED)
model.fit(train_x[train_x.columns[feature_list]], train_y)

pred = model.predict(test_x[test_x.columns[feature_list]])
submit('ridge_10_feature',pred)
```

<pre>
Done
</pre>
98점으로 약 2점가량 향상된 점수를 보임!



릿지모델을 통한 feature selection으로 성능향상을 노려봐야 할 것 같음

